<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<base href="/">

	

	

	
	<link href="/resources/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

	
	<link href="/resources/css/sb-admin-2.css" rel="stylesheet" type="text/css">
	<link href="/resources/css/site.css" rel="stylesheet" type="text/css">

	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<link rel="stylesheet" href="/resources/css/article.css" type="text/css">

	
	<link rel="icon" href="/assets/favicon.png">

	<title>Blazor InputFile Processing</title>
        <meta property="author" content="Shaun Curtis" />
        <meta property="description" content="This article demonstrates ways to handle processing files selected in an InputFile control including progress and cancellation." />
    <meta property="og:site_name" content="Cold Elm Coders" />
        <meta property="og:site" content="https://shauncurtis.github.io/" />
        <meta property="og:title" content="Blazor InputFile Processing" />
        <meta property="og:description" content="This article demonstrates ways to handle processing files selected in an InputFile control including progress and cancellation." /></head>
<body><header class="navbar bg-dark p-2 text-large text-light"><section class="navbar-section  text-light"><a href="/" class="navbar-brand mr-2 text-large text-light p-2">Cold Elm Coders</a>
			<a href="/Posts/index.html" class="btn btn-link text-light">Posts</a>
			<a href="/Rants/index.html" class="btn btn-link text-light">Rants</a>
			<a href="/Articles/index.html" class="btn btn-link text-light">Articles</a>
			<a href="/Stories/index.html" class="btn btn-link text-light">Stories</a>
			<a href="/about.html" class="btn btn-link text-light">About</a></section></header>

	<div class="container-fluid"><div class="row"><div class="col-12 col-sm-3 col-lg-2 bg-light pt-2"><div class="article-info p-2"><div class="mb-2">Published: 31-Oct-2023</div>
                <div class="mb-2">Updated: 31-Oct-2023</div>
                <div class="mb-2">Author: Shaun Curtis</div></div>
    <h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#the-scenario">The Scenario</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#summary">Summary</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
			
			<div class="col-12 col-sm-9 col-lg-10 p-2"><div class="pt-2 pb-2 border-bottom mb-4 text-primary"><h1>Blazor InputFile Processing</h1>
            <div><small>This article demonstrates ways to handle processing files selected in an InputFile control including progress and cancellation.</small></div></div>
    <p>I recently answered a question on using the the <code>InputFile</code> control.  The question was focused on how to deal with exceptions generated by  and cancellation of the activity associated with selecting one or more files.</p>
<p>The question highlighted issues with the MS Learn articles that the  asking party had used as the basis for their code, and the surfacing of exceptions produced in code running within a <code>Task</code> context.</p>
<p>I'll not go into the code that was presented, but focus on the code I came up with to address both the highlighted issues and some underlying problems the asker had not yet considered.</p>
<h2 id="the-scenario">The Scenario</h2>
<p>A page where you select one or more text files and the application calculates the number and frequency of unique words in each document.  The word algorithms are unimportant [they're elimentary], it's the state managment, exception and cancellation handling logic that this article focuses on.</p>
<h3 id="taskcompletionsource">TaskCompletionSource</h3>
<p>Before diving into the code, it's important to understand what the <code>TaskCompletionSource</code> object gives you as a coder, and how to use it.</p>
<p><code>TaskCompletionSource</code> is an object that provides control over a Task.  The <code>Task</code> is accessed through the <code>Task</code> property.  When a    <code>TaskCompletionSource</code> is created it's <code>Task</code>'s state is <em>running</em>.  To complete the <code>Task</code> you call <code>SetResult</code>.  There are also methods to handle setting the cancelled and error states on the Task.</p>
<h3 id="the-ui">The UI</h3>
<p>The UI has:</p>
<ul>
<li>a <code>InputFile</code> control with a cancellation button</li>
<li>a progress bar</li>
<li>an exception alert if an excpetion os generated</li>
<li>a list of process files wih their word count</li>
</ul>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
@page <span style="color:#D69D85;">&quot;/&quot;</span>
@inject FileCounterProvider FileCounterProvider
@implements IDisposable
&lt;PageTitle&gt;Index&lt;/PageTitle&gt;

&lt;h1&gt;Word Counter&lt;/h1&gt;

&lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;input-group mb-3&quot;</span>&gt;
    &lt;InputFile disabled=<span style="color:#D69D85;">&quot;@_isRunning&quot;</span> <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;form-control&quot;</span> OnChange=<span style="color:#D69D85;">&quot;@LoadFilesAsync&quot;</span> multiple /&gt;
    &lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;input-group-append&quot;</span>&gt;
        &lt;button disabled=<span style="color:#D69D85;">&quot;@_isNotRunning&quot;</span> <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;btn btn-danger&quot;</span> @onclick=<span style="color:#D69D85;">&quot;Cancel&quot;</span>&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;

@<span style="color:#569CD6;">if</span> (_isRunning)
{
    &lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;progress m-3&quot;</span>&gt;
        &lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;progress-bar&quot;</span> style=<span style="color:#D69D85;">&quot;width:@_progressBarStyle;&quot;</span> role=<span style="color:#D69D85;">&quot;progressbar&quot;</span> aria-valuenow=<span style="color:#D69D85;">&quot;@_processedPercent&quot;</span> aria-valuemin=<span style="color:#D69D85;">&quot;0&quot;</span> aria-valuemax=<span style="color:#D69D85;">&quot;100&quot;</span>&gt;&lt;/div&gt;
    &lt;/div&gt;
}

@<span style="color:#569CD6;">if</span> (_exceptionString <span style="color:#569CD6;">is</span> not <span style="color:#569CD6;">null</span>)
{
    &lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;alert alert-primary&quot;</span>&gt;
        @_exceptionString
    &lt;/div&gt;
}

@<span style="color:#569CD6;">if</span> (<span style="color:#569CD6;">this</span>.FileCounterProvider.FileDataList.Count() &gt; <span style="color:#B5CEA8;">0</span>)
{
    &lt;div <span style="color:#569CD6;">class</span>=<span style="color:#D69D85;">&quot;bg-dark text-white p-2 m-2&quot;</span>&gt;
        @<span style="color:#569CD6;">foreach</span> (<span style="color:#569CD6;">var</span> data <span style="color:#569CD6;">in</span> <span style="color:#569CD6;">this</span>.FileCounterProvider.FileDataList)
        {
            &lt;pre&gt;File: @data.FileName - Words : @data.Words.Count&lt;/pre&gt;

        }
    &lt;/div&gt;
}
</pre></div>
<p>We have a set of private class variables for UI state.</p>
<p>The important one is the <code>CancellationTokenSource</code>.  This manages a cancellation token.  It's nullable as it only has a value when the file process is running.  <code>IsRunning</code> checks if it's null.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
@code {
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">int</span> maxAllowedFiles = <span style="color:#B5CEA8;">3</span>;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">bool</span> _isNotRunning =&gt; _cancellationTokenSource <span style="color:#569CD6;">is</span> <span style="color:#569CD6;">null</span>;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">bool</span> _isRunning =&gt; _cancellationTokenSource <span style="color:#569CD6;">is</span> not <span style="color:#569CD6;">null</span>;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">string</span>? _exceptionString;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">long</span> _processedPercent;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">string</span> _progressBarStyle =&gt; $<span style="color:#D69D85;">&quot;{_processedPercent}%&quot;</span>;
    <span style="color:#569CD6;">private</span> CancellationTokenSource? _cancellationTokenSource;
</pre></div>
<p>The component methods are fairly standard stuff.  We wire up the <code>FileCounterProvider.ProcessedUpdated</code>, implement <code>IDisposable</code> and disconnect te event handler in <code>Dispose</code>.  The handler sets a local value and initiates a component render.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
    <span style="color:#569CD6;">protected</span> <span style="color:#569CD6;">override</span> <span style="color:#569CD6;">void</span> OnInitialized()
    {
        FileCounterProvider.ProcessedPercentUpdated += OnProcessUpdated;
    }

    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">void</span> OnProcessUpdated(<span style="color:#569CD6;">object</span>? sender, <span style="color:#569CD6;">long</span> Value)
    {
        _processedPercent = Value;
        <span style="color:#569CD6;">this</span>.InvokeAsync(StateHasChanged);
    }

    <span style="color:#569CD6;">public</span> <span style="color:#569CD6;">void</span> Dispose()
        =&gt; FileCounterProvider.ProcessedPercentUpdated -= OnProcessUpdated;
</pre></div>
<p><code>LoadFilesAsync</code> handles the <code>InputFile</code> change event.  It resets various Ui variables, creates a new <code>CancellationTokenSource</code> and calls <code>FileCounterProvider.LoadFiles</code>, passing it the <code>CancellationToken</code> associated with the <code>CancellationTokenSource</code>.</p>
<p>The cancel button handler simply calls <code>Cancel</code> on the <code>CancellationTokenSource</code>.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">async</span> Task LoadFilesAsync(InputFileChangeEventArgs e)
    {
        _processedPercent = <span style="color:#B5CEA8;">0</span>;
        _exceptionString = <span style="color:#569CD6;">null</span>;
        _cancellationTokenSource = <span style="color:#569CD6;">new</span>();

        <span style="color:#569CD6;">try</span>
        {
            <span style="color:#569CD6;">var</span> result = <span style="color:#569CD6;">await</span> <span style="color:#569CD6;">this</span>.FileCounterProvider.LoadFiles(e.GetMultipleFiles(maxAllowedFiles), _cancellationTokenSource.Token);
        }
        <span style="color:#569CD6;">catch</span> (Exception ex)
        {
            Console.WriteLine(<span style="color:#D69D85;">&quot;Exception&quot;</span>);
            _exceptionString = ex.Message;
        }
        <span style="color:#569CD6;">finally</span>
        {
            _cancellationTokenSource = <span style="color:#569CD6;">null</span>;
        }
    }

    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">void</span> Cancel()
        =&gt; _cancellationTokenSource?.Cancel();
</pre></div><h3 id="filedata">FileData</h3>
<p>FileData is a simple class to manage the word data associated with a file.  The word count logic is rudimentary: the article isn't about how to make this complete.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">public</span> <span style="color:#569CD6;">class</span> FileData
{
    <span style="color:#569CD6;">private</span> Dictionary&lt;<span style="color:#569CD6;">string</span>, <span style="color:#569CD6;">int</span>&gt; _words = <span style="color:#569CD6;">new</span>();

    <span style="color:#569CD6;">public</span> <span style="color:#569CD6;">string</span> FileName { <span style="color:#569CD6;">get</span>; <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">set</span>; } = <span style="color:#569CD6;">string</span>.Empty;
    <span style="color:#569CD6;">public</span> IReadOnlyDictionary&lt;<span style="color:#569CD6;">string</span>, <span style="color:#569CD6;">int</span>&gt; Words =&gt; _words.AsReadOnly();

    <span style="color:#569CD6;">public</span> FileData(<span style="color:#569CD6;">string</span> fileNme)
    {
        FileName = fileNme;
    }

    <span style="color:#569CD6;">public</span> <span style="color:#569CD6;">void</span> ProcessText(<span style="color:#569CD6;">string</span>? words)
    {
        <span style="color:#569CD6;">if</span> (words <span style="color:#569CD6;">is</span> <span style="color:#569CD6;">null</span>)
            <span style="color:#569CD6;">return</span>;

        <span style="color:#569CD6;">var</span> foundWords = words.Split(<span style="color:#D69D85;">&quot; &quot;</span>);

        <span style="color:#569CD6;">foreach</span> (<span style="color:#569CD6;">var</span> word <span style="color:#569CD6;">in</span> foundWords)
            <span style="color:#569CD6;">this</span>.AddWord(word);
    }

    <span style="color:#569CD6;">public</span> <span style="color:#569CD6;">void</span> AddWord(<span style="color:#569CD6;">string</span>? word)
    {
        <span style="color:#569CD6;">if</span> (word <span style="color:#569CD6;">is</span> <span style="color:#569CD6;">null</span>)
            <span style="color:#569CD6;">return</span>;

        <span style="color:#569CD6;">var</span> loweredWord = word.ToLower();
        <span style="color:#569CD6;">if</span> (_words.ContainsKey(loweredWord))
            _words[loweredWord]++;
        <span style="color:#569CD6;">else</span>
            _words.Add(loweredWord, <span style="color:#B5CEA8;">1</span>);
    }
}
</pre></div><h3 id="filecounterprovider">FileCounterProvider</h3>
<p>The public face of the Provider.  It has:</p>
<ul>
<li>A readonly <code>IEnumerable</code> collection of the processes file data</li>
<li>An <code>Event</code> tht is raisef when the precent uploaded has been updated.</li>
<li>A method to start the file processing.</li>
</ul>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">public</span> <span style="color:#569CD6;">class</span> FileCounterProvider
{
    <span style="color:#569CD6;">public</span> IEnumerable&lt;FileData&gt; FileDataList =&gt; _fileDataList.AsEnumerable();
    <span style="color:#569CD6;">public</span> <span style="color:#569CD6;">event</span> EventHandler&lt;<span style="color:#569CD6;">long</span>&gt;? ProcessedPercentUpdated;

    <span style="color:#569CD6;">public</span> Task&lt;<span style="color:#569CD6;">bool</span>&gt; LoadFiles(IReadOnlyList&lt;IBrowserFile&gt; files, CancellationToken cancellationToken);
</pre></div>
<p>The private class variables.  The two important ones are:</p>
<ul>
<li><code>_runningTask</code> is where the Task thjat is running the processing is assigned.</li>
<li><code>_taskCompletionSource</code> is our <code>Task</code> manager.</li>
</ul>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">public</span> <span style="color:#569CD6;">class</span> FileCounterProvider
{
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">long</span> maxFileSize = <span style="color:#B5CEA8;">1024</span> * <span style="color:#B5CEA8;">1024</span> * <span style="color:#B5CEA8;">1024</span>;
    <span style="color:#569CD6;">private</span> List&lt;FileData&gt; _fileDataList = <span style="color:#569CD6;">new</span> List&lt;FileData&gt;();
    <span style="color:#569CD6;">private</span> Task _runningTask = Task.CompletedTask;
    <span style="color:#569CD6;">private</span> TaskCompletionSource&lt;<span style="color:#569CD6;">bool</span>&gt;? _taskCompletionSource;
    <span style="color:#569CD6;">private</span> <span style="color:#569CD6;">int</span> _linesPerUpdate = <span style="color:#B5CEA8;">25</span>;
</pre></div>
<p><code>LoadFiles</code> starts the processing.  It:</p>
<ol>
<li>Checks if we are already running.  If so then just return false, and let the calling decide what to do.</li>
<li>Create a new <code>TaskCompletionSource</code>.</li>
<li>Start <code>ProcessFiles</code> and assign the <code>Task</code> to <code>_runningTask</code>.</li>
<li>Return the Task associated with <code>_taskCompletionSource</code>.</li>
</ol>
<p>Note that we are returning the Task from <code>_taskCompletionSource</code> which we have control over.  We'll see how we control this shortly.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">public</span> Task&lt;<span style="color:#569CD6;">bool</span>&gt; LoadFiles(IReadOnlyList&lt;IBrowserFile&gt; files, CancellationToken cancellationToken)
{
    <span style="color:#57A64A;">// If the manual task is currently running then return a false</span>
    <span style="color:#569CD6;">if</span> (_runningTask.IsCompleted)
        <span style="color:#569CD6;">return</span> Task.FromResult(<span style="color:#569CD6;">false</span>);

    <span style="color:#57A64A;">// Create a new &quot;running&quot; manual task</span>
    _taskCompletionSource = <span style="color:#569CD6;">new</span>();
    <span style="color:#57A64A;">// start the internal process and assign the task</span>
    <span style="color:#57A64A;">// there&#39;s no await</span>
    _runningTask = ProcessFiles(files, cancellationToken);

    <span style="color:#57A64A;">// Return the running manual task</span>
    <span style="color:#569CD6;">return</span> _taskCompletionSource.Task;
}
</pre></div>
<p>Next the reader for each file.  I've added inline commentary to explain the functionality.  Note that there's no exception handling here.  any exception will feed straight back to the caller.  If the user sets the cancellation token, the method simply stops processing and returns.  Note the <code>using</code> on the file stream methods to ensure they are disposed correctly, exception or no exception.</p>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">private</span> <span style="color:#569CD6;">async</span> Task ReadAsync(IBrowserFile file, CancellationToken cancellationToken)
{
    <span style="color:#569CD6;">var</span> fileData = <span style="color:#569CD6;">new</span> FileData(file.Name);
    <span style="color:#569CD6;">var</span> fileSize = file.Size;

    <span style="color:#569CD6;">using</span> <span style="color:#569CD6;">var</span> stream = file.OpenReadStream(maxFileSize, cancellationToken);
    <span style="color:#569CD6;">using</span> <span style="color:#569CD6;">var</span> reader = <span style="color:#569CD6;">new</span> StreamReader(stream);

    <span style="color:#569CD6;">var</span> line = <span style="color:#569CD6;">await</span> reader.ReadLineAsync();
    <span style="color:#569CD6;">long</span> processed = <span style="color:#B5CEA8;">0</span>;
    <span style="color:#569CD6;">int</span> lines = <span style="color:#B5CEA8;">0</span>;

    <span style="color:#569CD6;">while</span> (line <span style="color:#569CD6;">is</span> not <span style="color:#569CD6;">null</span>)
    {
        lines++;
        processed = processed + (line.Length);

        <span style="color:#57A64A;">// Slow it down so we can cancel it manually</span>
        <span style="color:#569CD6;">await</span> Task.Delay(<span style="color:#B5CEA8;">1</span>);

        <span style="color:#57A64A;">// check the cancellation task to see if the user wants out.</span>
        <span style="color:#569CD6;">if</span> (cancellationToken.IsCancellationRequested)
            <span style="color:#569CD6;">return</span>;

        <span style="color:#57A64A;">// process the line</span>
        fileData.ProcessText(line);

        <span style="color:#57A64A;">// Raise the Processed event every 25 lines to update the progress in the UI</span>
        <span style="color:#569CD6;">if</span> (lines &gt; _linesPerUpdate)
        {
            <span style="color:#569CD6;">var</span> percent = ((processed * <span style="color:#B5CEA8;">100</span>) / fileSize);
            <span style="color:#569CD6;">this</span>.ProcessedPercentUpdated?.Invoke(<span style="color:#569CD6;">null</span>, percent);
            lines = <span style="color:#B5CEA8;">0</span>;
        }

        <span style="color:#57A64A;">// Read the next line</span>
        line = <span style="color:#569CD6;">await</span> reader.ReadLineAsync();
    }

    <span style="color:#57A64A;">// Add the processed data to the File Data list</span>
    _fileDataList.Add(fileData);

    <span style="color:#57A64A;">// Set the final progress value to 100% as we&#39;ve finished</span>
    <span style="color:#569CD6;">this</span>.ProcessedPercentUpdated?.Invoke(<span style="color:#569CD6;">null</span>, <span style="color:#B5CEA8;">100</span>);
}
</pre></div>
<p>Finally the <code>LoadFiles</code> method.  This handles all the exception handling and cancellation.  Note that when <code>ReadAsync</code> returns we check the cancellation state to see <code>ReadAsync</code> existed early due to a cancellation.  If it does, we call <code>cancellationToken.ThrowIfCancellationRequested</code>.  We capture exceptions and then set the <code>_taskCompletionSource</code> correctly for what happens in the processing.  So if:</p>
<ol>
<li>The process completes, it calls <code>SetResult</code>.</li>
<li>The process stops due to a cancellation, it calls <code>SetCanceled</code>.</li>
<li>The process errors with an excpetion, it calls <code>SetException</code>.</li>
</ol>
<div style="color:#DADADA;background-color:#1E1E1E;"><pre>
<span style="color:#569CD6;">private</span> <span style="color:#569CD6;">async</span> Task ProcessFiles(IReadOnlyList&lt;IBrowserFile&gt; files, CancellationToken cancellationToken)
{
    _fileDataList = <span style="color:#569CD6;">new</span> List&lt;FileData&gt;();

    <span style="color:#569CD6;">foreach</span> (<span style="color:#569CD6;">var</span> file <span style="color:#569CD6;">in</span> files)
    {
        <span style="color:#569CD6;">try</span>
        {
            <span style="color:#569CD6;">await</span> ReadAsync(file, cancellationToken);

            <span style="color:#57A64A;">// check the cancellation task to see if the user wants out.</span>
            <span style="color:#569CD6;">if</span> (cancellationToken.IsCancellationRequested)
                cancellationToken.ThrowIfCancellationRequested();
        }

        <span style="color:#57A64A;">// catch a cancellation exception and pass it by setting the manual task</span>
        <span style="color:#569CD6;">catch</span> (OperationCanceledException)
        {
            _taskCompletionSource?.SetCanceled(cancellationToken);
            <span style="color:#569CD6;">return</span>;
        }

        <span style="color:#57A64A;">// Catch any other task and pass it on through the manula task.</span>
        <span style="color:#569CD6;">catch</span> (Exception ex)
        {
            _taskCompletionSource?.SetException(ex);
            <span style="color:#569CD6;">return</span>;
        }
    }

    <span style="color:#57A64A;">// everything completed so set the Task to Complete.</span>
    _taskCompletionSource?.SetResult(<span style="color:#569CD6;">true</span>);
}
</pre></div><h2 id="summary">Summary</h2>
<p>The key concept user here is a Task that you are the coder have control over.  The Task or Tasks returned within the processing are internal to <code>FileCounterProvider</code>.  The UI can await the managed Task and only continue once processing within the <code>FileCounterProvider</code> completes.</p>
</div></div></div></body></html>





