<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="Notes about Nullable and breaking changes in Visual Studio 2022" >
<meta name="author" content="Shaun Curtis" >



<title>Nullable in Visual Studio 2022</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="45596042-42f3-4dbc-823e-c8f435f84299" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="45596042-42f3-4dbc-823e-c8f435f84299" >
<a class="dropdown-item" href="/articles/A-Flexible-app.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Brick-By-Brick.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Brick By Brick
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/Building-Blazor-List-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor List Components and the Notification Pattern
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/Policy-Based-Authorization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Policy Base Authorization in Blazor
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
<a class="dropdown-item" href="/articles/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="2bbbb753-7480-45ab-9ba7-af160a31738b" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="2bbbb753-7480-45ab-9ba7-af160a31738b" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="5e727174-cec1-4d5f-b829-13471ba7e33f" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Building Blazor Applications</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="5e727174-cec1-4d5f-b829-13471ba7e33f" >
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Bootstrap-Toaster.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Bootstrap Toaster
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Services
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-A-Blazor-AutoComplete-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Blazor Autocomplete Control
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-Wrapper-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Wrapper Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Leaner-Meaner-Greener-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Leaner Meaner Greener Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Notification Service Pattern
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Rethinking-The-Repository-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Rethinking The Repository Pattern
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/The-Blazor-WASM-Hosted-Project.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor WASM Hosted Project
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Whats-Wrong-with-my-Component-Design.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Whats Wrong With My Component Design
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/The-Blazor-Component" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor Applications\The Blazor Component
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="771fbf1c-e94a-45ce-b8c8-c67e2520f62d" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="771fbf1c-e94a-45ce-b8c8-c67e2520f62d" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="5c09b406-c047-423d-b733-69911dc3677d" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="5c09b406-c047-423d-b733-69911dc3677d" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 27-11-2021 >
<div>Published: 27-11-2021</div>
<div>Last Updated: 27-11-2021</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#visual-studio-2022">Visual Studio 2022</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#simple-nullable">Simple Nullable</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#nullable-detection">Nullable Detection</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#edge-case">Edge Case</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#real-world-edge-case">Real World Edge Case</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#breaking-the-rules">Breaking The Rules</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#null-coalescing">Null Coalescing</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#some-observations-and-suggestions">Some Observations and Suggestions</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>Nullable in Visual Studio 2022</h1>
<div>Notes about Nullable and breaking changes in Visual Studio 2022</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <p>Nulls have always presented programming challenges.</p>
<p>To define a null, I'll quote MS-Docs:</p>
<blockquote>
<p>The null keyword is a literal that represents a null reference, one that does not refer to any object. null is the default value of reference-type variables. Ordinary value types cannot be null, except for nullable value types.</p>
</blockquote>
<p>C# 8 introduced nullable reference types.  A system where reference types could no longer be null unless explicitly declared with the <code>?</code> operator.</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// not nullable fields/properties must be assigned a value</span>
<span class="hljs-keyword">string</span> notNullableValue = <span class="hljs-keyword">string</span>.Empty;

<span class="hljs-keyword">string</span>? NullableValue; 

<span class="hljs-comment">// nullable is controlled by the return value from the method </span>
<span class="hljs-keyword">var</span> <span class="hljs-keyword">value</span> = SomeMethod();
</div></code></pre>
<p>For many programmers this had no consequences because the project templates by default did not enable <em>Nullable</em>.  We sailed on serenely in ignorance.</p>
<p>With <em>Nullable</em> enabled the compiler throws warnings whenever it considers you've broken the rules.  It's pretty good, but there are certain circumstances where you want to break the rules, and edge cases where it gets things wrong.  We'll look at both of those later.</p>
<h2 id="visual-studio-2022">Visual Studio 2022</h2>
<p>Visual Studio 2022 moved the goalposts: <code>Nullable</code> is now enabled by default.  Here's the project file for a console app:</p>
<pre><code class="language-xml"><div>  <span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">OutputType</span>&gt;</span>Exe<span class="hljs-tag">&lt;/<span class="hljs-name">OutputType</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>net6.0<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ImplicitUsings</span>&gt;</span>enable<span class="hljs-tag">&lt;/<span class="hljs-name">ImplicitUsings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Nullable</span>&gt;</span>enable<span class="hljs-tag">&lt;/<span class="hljs-name">Nullable</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span>
</div></code></pre>
<p>You now have to explicitly disable it.  Write code the old way, or import existing code and unless you were a miracle coder,  you will see a lot of null code warnings and errors.  It has certainly impacted my coding style and practices.</p>
<p>Let's look at some code to see what I mean.</p>
<h2 id="simple-nullable">Simple Nullable</h2>
<p>Here's some simple old style code.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span>;

<span class="hljs-keyword">value</span> = getHello(<span class="hljs-number">0</span>);

Console.WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-function"><span class="hljs-keyword">string</span> <span class="hljs-title">getHello</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> test</span>)</span>
    =&gt;  test == <span class="hljs-number">1</span>
        ? <span class="hljs-string">&quot;Hello World&quot;</span>
        : <span class="hljs-literal">null</span>;
</div></code></pre>
<p>Disable Nullable and this code flies: no exceptions or warnings.  So what's the problem?</p>
<p>String can be a null, so we can pass null strings around.  Unless we explicitly check, we don't know if <code>Console.WriteLine</code> handles nulls correctly.  If it doesn't we will get an exception when we pass it a null.  Everything flies because <code>Console.WriteLine</code> knows how to handle nulls.  It's definition looks like this:</p>
<pre><code class="language-csharp"><div>Console.WriteLine(<span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>) 
</div></code></pre>
<p>Enable Nullable and we see a warning - <em>Possible Null Reference Return</em> on <code>getHello</code>.  Why?</p>
<ol>
<li><code>getHello</code> declares it's return value as <code>string</code>.  No <code>?</code> and therefore not nullable, yet in the body we can return <code>null</code>.</li>
<li><code>string value</code> also declares <code>value</code> as not nullable.</li>
</ol>
<p>To fix this:</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>;

<span class="hljs-keyword">value</span> = getHello(<span class="hljs-number">0</span>);

Console.WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-keyword">string</span>? getHello(<span class="hljs-keyword">int</span> test)
    =&gt;  test == <span class="hljs-number">1</span>
        ? <span class="hljs-string">&quot;Hello World&quot;</span>
        : <span class="hljs-literal">null</span>;
</div></code></pre>
<p>We've added the nullable <code>?</code> operator to <code>value</code> and the return declaration of <code>getHello</code>.</p>
<p>We're now declaring and handling nullables correctly and the compiler is happy,</p>
<h2 id="nullable-detection">Nullable Detection</h2>
<p>Our new block of code</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>;

<span class="hljs-keyword">var</span> sometest = <span class="hljs-literal">true</span>;

<span class="hljs-keyword">value</span> = sometest
        ? <span class="hljs-string">&quot;Hello World&quot;</span>
        : <span class="hljs-string">&quot;Bye World&quot;</span>;

WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-keyword">value</span> = sometest
        ? <span class="hljs-string">&quot;Hello World&quot;</span>
        : <span class="hljs-literal">null</span>;

<span class="hljs-comment">// Get a possible null warning</span>
WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WriteLine</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span></span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-keyword">value</span>);
</div></code></pre>
<p>We have our own <code>WriteLine</code> method with a <em>not nullable</em> string argument.  note that we only get a compiler warning after yhe second assignment to value where we try and assign a <code>null</code>.  The compiler is analysing the code, seeing a possble null and throwing a warning.</p>
<p>We fix this by changing <code>WriteLne</code> to accept a nullable string.  The compiler knows <code>Console.WriteLine</code> accepts nullable strings so everything is good.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WriteLine</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span></span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-keyword">value</span>);
</div></code></pre>
<h2 id="edge-case">Edge Case</h2>
<p>The contrived code below illustrates one common problem.  We know once we've called <code>GetAsync</code> and assigned <code>value</code> it can't be null because we throw an error if it is.  However, the analyser isn't that clever so still throws the warning.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span> = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">var</span> myClass = <span class="hljs-keyword">new</span> MyClass();

<span class="hljs-keyword">await</span> myClass.GetAsync();

<span class="hljs-keyword">value</span> = myClass.Value;

<span class="hljs-comment">// We know it&#x27;s safe to pass Value because it can&#x27;t be null</span>
<span class="hljs-comment">// but the code doesn&#x27;t so still throws a warning</span>
WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WriteLine</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span></span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-keyword">value</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Value { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">GetAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">await</span> Task.Yield();
        <span class="hljs-comment">// Get the value from a service</span>
        <span class="hljs-keyword">this</span>.Value = <span class="hljs-string">&quot;Hello World&quot;</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.Value <span class="hljs-keyword">is</span> <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-string">&quot;Value is null and shouldn&#x27;t be!&quot;</span>);
    }
}
</div></code></pre>
<p>We can suppress these messages using the ! null forgiving operator.  In the code above, the correct place to apply it is where the assignment takes place.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">value</span> = myClass.Value!;
</div></code></pre>
<p>Don't apply it to where it's being used.</p>
<pre><code class="language-csharp"><div>WriteLine(<span class="hljs-keyword">value</span>!);
</div></code></pre>
<p>Two notes:</p>
<blockquote>
<p>Don't use it unless you have to.  Use null coalesing - covered below - wherever you can.</p>
</blockquote>
<blockquote>
<p>The null forgiving operator has no effect in compilation.  It's just a succinct message from the programmer to the compiler/interpreter saying &quot;No worries mate, bin the warnings, I've got it covered!&quot;.</p>
</blockquote>
<h2 id="real-world-edge-case">Real World Edge Case</h2>
<p>The example above may be contrived, but consider the following code from a Blazor page.</p>
<pre><code class="language-csharp"><div>[<span class="hljs-meta">Inject</span>] MyService? myService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DoSomething</span>(<span class="hljs-params"></span>)</span>
{
    <span class="hljs-comment">// nullable warning on myService</span>
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">value</span> = myService.Value;
}
</div></code></pre>
<p>Blazor ensures <code>MyService</code> is registered: it throws an exception if it isn't.  We could code:</p>
<pre><code class="language-csharp"><div>[<span class="hljs-meta">Inject</span>] MyService myService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-keyword">new</span> MyService();
</div></code></pre>
<p>Which works, but is just <em>wrong</em>.  We're creating an object for a contrived reason, and it's absolutely useless created outside the DI container context.</p>
<p>We could use null forgiving when we use the object, which is ok when you use ut once, but say you use the service ten times in you code block, it doesn't seem right.</p>
<p>My current best solution is to use a local variable in a code block like this:</p>
<pre><code class="language-csharp"><div>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DoSomething</span>(<span class="hljs-params"></span>)</span>
    {
        MyService service = myService!;
        <span class="hljs-keyword">var</span> <span class="hljs-keyword">value</span> = service.Value;
        ....
    }
</div></code></pre>
<h2 id="breaking-the-rules">Breaking The Rules</h2>
<p>Not often, but testing is one area where you may break the rules to test null handling and boundary conditions.</p>
<h2 id="null-coalescing">Null Coalescing</h2>
<p>The normal approach to the &quot;boxing&quot; problem of switching from nullable to non nullable is to use null coalescing <code>??</code>.</p>
<p>We can use it on  <code>Writeline</code> like this.  <code>Writeline</code> now receives <code>value</code> if it isn't <code>null</code>, or <code>string,Empty</code> if it is.</p>
<pre><code class="language-csharp"><div>WriteLine(<span class="hljs-keyword">value</span> ?? <span class="hljs-keyword">string</span>.Empty);
</div></code></pre>
<p>We can also use the very useful null coalescing assignment operator <code>??=</code> like this whenever we need to make sure a value isn't null:</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">value</span> ??= <span class="hljs-keyword">string</span>.Empty;
WriteLine(<span class="hljs-keyword">value</span>);
</div></code></pre>
<p>More succinct than:</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">if</span> (<span class="hljs-keyword">value</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">null</span>)
{
    <span class="hljs-keyword">value</span> = <span class="hljs-keyword">string</span>.Empty;
}
</div></code></pre>
<h2 id="some-observations-and-suggestions">Some Observations and Suggestions</h2>
<ol>
<li>Don't chicken out, leave <strong>Nullable</strong> enabled.</li>
<li>A lot of null checking code becomes obselete by ensuring you pass not nullable objects into methods.</li>
<li>Get familiar with <em>Null Coalescing</em>.</li>
<li>Don't splatter <em>null forgiving !</em> marks across your code.  Ask yourself Why?  Is this a boundary condition or just lazy coding?</li>
</ol>

    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2022</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
