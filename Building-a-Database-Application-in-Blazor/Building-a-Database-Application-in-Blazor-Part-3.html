<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="This article describes building the Edit and View UI components for a Blazor Database Application." >
<meta name="author" content="Shaun Curtis" >



<title>Part 3 - A Blazor Database Template - Building Edit and View UI Components</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="3c8fac19-0bd1-4944-88a8-ca37c9e84c23" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="3c8fac19-0bd1-4944-88a8-ca37c9e84c23" >
<a class="dropdown-item" href="/articles/A-Flexible-App.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Brick-By-Brick.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Brick By Brick
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/Building-Blazor-List-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor List Components and the Notification Pattern
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/Policy-Based-Authorization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Policy Base Authorization in Blazor
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="b03c28c4-66d3-431e-a807-72e884ecc42d" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="b03c28c4-66d3-431e-a807-72e884ecc42d" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="61786138-2d09-41b9-8daf-3dab47008e8b" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Building Blazor Applications</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="61786138-2d09-41b9-8daf-3dab47008e8b" >
<a class="dropdown-item" href="/Building-Blazor-Applications/Rebuilding-Counter.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Rebuilding Counter
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="377d2197-75ef-44d2-b5cb-b75fdb5c7b16" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="377d2197-75ef-44d2-b5cb-b75fdb5c7b16" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="c17824bf-6504-46de-9c28-46990a486569" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="c17824bf-6504-46de-9c28-46990a486569" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="4da49b10-8d5a-481e-bc1f-421647cc85c7" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Posts</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="4da49b10-8d5a-481e-bc1f-421647cc85c7" >
<a class="dropdown-item" href="/posts/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/posts/Blazor-Bootstrap-Toaster.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Bootstrap Toaster
</a>
<a class="dropdown-item" href="/posts/Blazor-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Services
</a>
<a class="dropdown-item" href="/posts/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/posts/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/posts/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/posts/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Notification Service Pattern
</a>
<a class="dropdown-item" href="/posts/The-Blazor-WASM-Hosted-Project.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor WASM Hosted Project
</a>
<a class="dropdown-item" href="/posts/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 15-09-2020 >
<div>Published: 15-09-2020</div>
<div>Last Updated: 04-07-2021</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#introduction">Introduction</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#sample-project-code-and-demo-site">Sample Project, Code and Demo Site</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#the-base-forms">The Base Forms</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#recordformbase">RecordFormBase</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#editrecordformbase">EditRecordFormBase</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#edit-state-management">Edit State Management</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#implementing-forms">Implementing Forms</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastviewerform">WeatherForecastViewerForm</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecasteditorform">WeatherForecastEditorForm</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#routeview-implementations">RouteView Implementations</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#wrap-up">Wrap Up</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#history">History</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>Part 3 - A Blazor Database Template - Building Edit and View UI Components</h1>
<div>This article describes building the Edit and View UI components for a Blazor Database Application.</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <div class="alert alert-danger">This set of articles and code base is out of date. They don't reflect my current framework. Use them at your risk.</div>
<h2 id="introduction">Introduction</h2>
<p>This is the third in a series of articles looking at how to build and structure a Database Application in Blazor. The articles so far are:</p>
<ol>
<li>Project Structure and Framework.</li>
<li>Services - Building the CRUD Data Layers.</li>
<li>View Components - CRUD Edit and View Operations in the UI.</li>
<li>UI Components - Building HTML/CSS Controls.</li>
<li>View Components - CRUD List Operations in the UI.</li>
</ol>
<p>This article looks in detail at building reusable CRUD presentation layer components, specifically Edit and View functionality.  There are significant changes since the first release.</p>
<p>I find it interesting that most programmers try and automate Edit And View forms by building a control factory rather than boilerplating everything else. Most forms are unique to their record set.  Certain fields can be grouped together and put on the same line.  Text fields change in length depending on how many characters they need.  Building a factory to handle this, plus the added complication of linkages between the control, the dataclass instance and validation, doesn't seem worth it.  The configuration dataset becomes more complicated than the form it's trying to mimic.  For those reasons there's no form factory here, just a set of libary UI component classes to standardise form building.</p>
<h2 id="sample-project-code-and-demo-site">Sample Project, Code and Demo Site</h2>
<p>The repository for the articles has moved to <a href="https://github.com/ShaunCurtis/Blazor.Database">Blazor.Database Repository</a>.  All previous repos are obselete and will be removed shortly.</p>
<p>There's a SQL script in /SQL in the repository for building the database.</p>
<p>The demo site has changed now the Server and WASM have been combined.  The site starts in Server mode - <a href="https://cec-blazor-database.azurewebsites.net/">https://cec-blazor-database.azurewebsites.net/</a>.</p>
<p>The List Form
<img src="file:////siteimages/Articles/Database/FetchData-List.png" alt="Weather Forecast Viewer"></p>
<p>The Modal Viewer
<img src="file:////siteimages/Articles/Database/WeatherForecast-Viewer.png" alt="Weather Forecast Viewer"></p>
<p>The Inline Editor
<img src="file:////siteimages/Articles/Database/WeatherForecast-Editor.png" alt="Weather Forecast Viewer"></p>
<p>Edit State Control
<img src="file:////siteimages/Articles/Database/Editor-dirty-Exit.png" alt="Weather Forecast Viewer"></p>
<p>Several custom controls are used in the forms.  The detail on these is covered in separate articles:</p>
<p>Code Project Articles:</p>
<ul>
<li><a href="https://www.codeproject.com/Articles/5297299/A-Blazor-Edit-Form-State-Control">EditFormState Control</a></li>
<li><a href="https://www.codeproject.com/Articles/5297302/A-Blazor-Validation-Control">EditValidationState Control</a></li>
<li><a href="https://www.codeproject.com/Articles/5297432/A-Blazor-Inline-Dialog-Control">InlineDialog Control</a></li>
<li><a href="https://www.codeproject.com/Articles/5294466/A-Blazor-Modal-Dialog-Editor">ModalDialog Control</a></li>
</ul>
<p>This Repo Originals:</p>
<ul>
<li><a href="articles/Building-Edit-Forms.html">EditFormState</a></li>
<li><a href="/articles/validationformstate.html">EditValidationState Control</a></li>
<li><a href="/articles/inline-dialog.html">InlineDialog Control</a></li>
<li><a href="/articles/bootstrap-modal-dialog.html">ModalDialog Control</a></li>
</ul>
<h2 id="the-base-forms">The Base Forms</h2>
<p>All Razor based UI components inherit from <code>ComponentBase</code> unless otherwise specified. All source files can be viewed on the Github site, and I include references or links to specific code files at appropriate places in the article.  In most places you need to read through the code for detailed commentary on functionality.</p>
<h3 id="recordformbase">RecordFormBase</h3>
<p><code>RecordFormBase</code> is the base abstract class used by the record forms. It inherits from <code>ComponentBase</code>.  Instances of Record Forms can exist in several UI contexts:</p>
<ol>
<li>As the root component in a RouteView, where the RouteView passes the form the <code>Id</code> via a Parameter.</li>
<li>Within a modal dialog in a list or other component.  The ID is passed to the form through a <code>DialogOptions</code> class.</li>
<li>As an inline editor within another component such as a list, where the component passes the form the <code>Id</code> via a Parameter.</li>
</ol>
<p><code>RecordFormBase</code> detects if it is within a modal dialog context by checking for a cascaded <code>IModalDialog</code> object.  There are two sets of dependancies:</p>
<ol>
<li>The <code>Id</code> of the record.  This is either passed as a <code>Parameter</code> if the form is hosted in a RouteView or other component, or in a public <code>ModalOptions</code> property of <code>IModalDialog</code>.</li>
<li>The Exit mechanism.  The form exits by either:
<ol>
<li>Calling close on <code>Modal</code> if it's in a modal context.</li>
<li>Calling the <code>ExitAction</code> delegate if one if registered.</li>
<li>The default - exit to the site root.</li>
</ol>
</li>
</ol>
<p>Namespace : <em>Razr.SPA.Components</em></p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// Namespace: *Razr.SPA.Components*</span>
<span class="hljs-comment">// Domain: UI Domain</span>
<span class="hljs-comment">// File: Blazr.SPA/Forms/RecordFormBase.cs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RecordFormBase</span>&lt;<span class="hljs-title">TRecord</span>&gt; :
    <span class="hljs-title">ComponentBase</span>
    <span class="hljs-keyword">where</span> <span class="hljs-title">TRecord</span> : <span class="hljs-keyword">class</span>, <span class="hljs-title">IDbRecord</span>&lt;<span class="hljs-title">TRecord</span>&gt;, <span class="hljs-title">new</span>()
{
    [<span class="hljs-meta">CascadingParameter</span>] <span class="hljs-keyword">public</span> IModalDialog Modal { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> Guid ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = Guid.Empty;
    [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> EventCallback ExitAction { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">protected</span> NavigationManager NavManager { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-keyword">protected</span> IModelViewService&lt;TRecord&gt; Service { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-built_in">bool</span> IsLoaded =&gt; <span class="hljs-keyword">this</span>.Service != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.Service.Record != <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> ComponentState LoadState =&gt; IsLoaded ? ComponentState.Loaded : ComponentState.Loading;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-built_in">bool</span> HasServices =&gt; <span class="hljs-keyword">this</span>.Service != <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> IsModal =&gt; <span class="hljs-keyword">this</span>.Modal != <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">protected</span> Guid _modalId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = Guid.Empty;
    <span class="hljs-keyword">protected</span> Guid _Id =&gt; TryGetModalID() ? _modalId : <span class="hljs-keyword">this</span>.ID;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">override</span> Task <span class="hljs-title">OnInitializedAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">// Get the record</span>
        <span class="hljs-keyword">await</span> LoadRecordAsync();
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">base</span>.OnInitializedAsync();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">LoadRecordAsync</span>(<span class="hljs-params"></span>)</span>
        =&gt; <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.Service.GetRecordAsync(<span class="hljs-keyword">this</span>._Id);

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">TryGetModalID</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.IsModal &amp;&amp; <span class="hljs-keyword">this</span>.Modal.Options.TryGet&lt;Guid&gt;(<span class="hljs-string">&quot;Id&quot;</span>, <span class="hljs-keyword">out</span> Guid <span class="hljs-keyword">value</span>))
        {
            <span class="hljs-keyword">this</span>._modalId = <span class="hljs-keyword">value</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Exit</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">// If we&#x27;re in a modal context, call Close on the cascaded Modal object</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.IsModal)
            <span class="hljs-keyword">this</span>.Modal.Close(ModalResult.OK());
        <span class="hljs-comment">// If there&#x27;s a delegate registered on the ExitAction, execute it. </span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ExitAction.HasDelegate)
            <span class="hljs-keyword">await</span> ExitAction.InvokeAsync();
        <span class="hljs-comment">// else fallback action is to navigate to root</span>
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.NavManager.NavigateTo(<span class="hljs-string">&quot;/&quot;</span>);
    }
}
</div></code></pre>
<h3 id="editrecordformbase">EditRecordFormBase</h3>
<p><code>EditRecordFormBase</code> is the base editor form. It inherits from <code>RecordFormBase</code> and implements editing functionality. <code>TEditRecord</code> is the editable class for <code>TRecord</code>.</p>
<p>It:</p>
<ol>
<li>Creates an instance of <code>TEditRecord</code> caled <code>Model</code> and populates it from <code>TRecord</code>.</li>
<li>Retrieves the dirty dataset from <code>EditStateService</code> if one exists.</li>
<li>Assigns the <code>TEditRecord</code> to the <code>EditContext</code> and manages the <code>EditContext</code>.</li>
<li>Has a set of Boolean Properties to track state and manage button display/disabled state.</li>
<li>Saves the record.</li>
</ol>
<p>The form &quot;locks&quot; the browser page when the form is dirty.</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// Namespace: *Razr.SPA.Components*</span>
<span class="hljs-comment">// Domain: UI Domain</span>
<span class="hljs-comment">// File: Blazr.SPA/Forms/EditRecordFormBase.cs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EditRecordFormBase</span>&lt;<span class="hljs-title">TRecord</span>, <span class="hljs-title">TEditRecord</span>&gt; :
    <span class="hljs-title">RecordFormBase</span>&lt;<span class="hljs-title">TRecord</span>&gt;,
    <span class="hljs-title">IDisposable</span>
    <span class="hljs-keyword">where</span> <span class="hljs-title">TRecord</span> : <span class="hljs-keyword">class</span>, <span class="hljs-title">IDbRecord</span>&lt;<span class="hljs-title">TRecord</span>&gt;, <span class="hljs-title">new</span>()
    <span class="hljs-keyword">where</span> <span class="hljs-title">TEditRecord</span> : <span class="hljs-keyword">class</span>, <span class="hljs-title">IEditRecord</span>&lt;<span class="hljs-title">TRecord</span>&gt;, <span class="hljs-title">new</span>()
{
    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">private</span> IJSRuntime _js { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">protected</span> EditStateService EditStateService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-keyword">protected</span> EditContext EditContext { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> IsDirty =&gt; <span class="hljs-keyword">this</span>.EditStateService.IsDirty;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-built_in">string</span> FormUrl { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">protected</span> TEditRecord Model { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-comment">// Set of boolean properties/fields used in the razor code and methods to track </span>
    <span class="hljs-comment">// state in the form or disable/show/hide buttons.</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _isNew =&gt; <span class="hljs-keyword">this</span>.Service?.IsNewRecord ?? <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _isValid { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _saveDisabled =&gt; !<span class="hljs-keyword">this</span>.IsDirty || !<span class="hljs-keyword">this</span>._isValid;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _deleteDisabled =&gt; <span class="hljs-keyword">this</span>._isNew || <span class="hljs-keyword">this</span>._confirmDelete || <span class="hljs-keyword">this</span>.IsDirty;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _isLoaded { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _dirtyExit =&gt; <span class="hljs-keyword">this</span>.IsDirty;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _confirmDelete { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">bool</span> _isInlineDirty =&gt; (!<span class="hljs-keyword">this</span>.IsModal) &amp;&amp; <span class="hljs-keyword">this</span>.IsDirty;
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">string</span> _saveButtonText =&gt; <span class="hljs-keyword">this</span>._isNew ? <span class="hljs-string">&quot;Save&quot;</span> : <span class="hljs-string">&quot;Update&quot;</span>;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> ComponentState LoadState =&gt; _isLoaded ? ComponentState.Loaded : ComponentState.Loading;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">LoadRecordAsync</span>(<span class="hljs-params"></span>)</span>
    {
        _isLoaded = <span class="hljs-literal">false</span>;
        <span class="hljs-comment">// Get the ID either from a ModalDialog Options or the Id Parameter and set the local id</span>
        <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>._Id;
        <span class="hljs-comment">// Check if we have a dirty form reload and if so get the Id from the EditStateService</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.EditStateService.IsDirty)
            id = (Guid)<span class="hljs-keyword">this</span>.EditStateService.RecordID;
        <span class="hljs-comment">// Get the record</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.Service.GetRecordAsync(id);
        <span class="hljs-comment">// Get a new Edit class instance, populate it from the record and assign it to the EditContext</span>
        <span class="hljs-keyword">this</span>.Model = <span class="hljs-keyword">new</span> TEditRecord();
        <span class="hljs-keyword">this</span>.Model.Populate(<span class="hljs-keyword">this</span>.Service.Record);
        <span class="hljs-keyword">this</span>.EditContext = <span class="hljs-keyword">new</span> EditContext(<span class="hljs-keyword">this</span>.Model);
        <span class="hljs-comment">// Set up the EditStateService FirmUrl and Record Id</span>
        <span class="hljs-keyword">this</span>.EditStateService.EditFormUrl = FormUrl ?? NavManager.Uri;
        <span class="hljs-keyword">this</span>.EditStateService.RecordID = id;
        _isLoaded = <span class="hljs-literal">true</span>;
        <span class="hljs-comment">// wire up the events</span>
        <span class="hljs-keyword">this</span>.EditContext.OnFieldChanged += FieldChanged;
        <span class="hljs-keyword">this</span>.EditStateService.EditStateChanged += OnEditStateChanged;
        <span class="hljs-comment">// if we have a dirty record or are editing an existing record, run validation</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isNew)
            <span class="hljs-keyword">this</span>.EditContext.Validate();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FieldChanged</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, FieldChangedEventArgs e</span>)</span>
        =&gt;  <span class="hljs-keyword">this</span>._confirmDelete = <span class="hljs-literal">false</span>;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnEditStateChanged</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EditStateEventArgs e</span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.IsModal) <span class="hljs-keyword">this</span>.Modal.Lock(e.IsDirty);
        <span class="hljs-keyword">this</span>.InvokeAsync(StateHasChanged);
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ValidStateChanged</span>(<span class="hljs-params"><span class="hljs-built_in">bool</span> valid</span>)</span>
        =&gt; <span class="hljs-keyword">this</span>._isValid = valid;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HandleValidSubmit</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">// Get the readonly record to submit</span>
        <span class="hljs-keyword">var</span> rec = <span class="hljs-keyword">this</span>.Model.GetRecord();
        <span class="hljs-comment">// Save the record</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.Service.SaveRecordAsync(rec);
        <span class="hljs-comment">// Update the EditStateService to clean</span>
        <span class="hljs-keyword">this</span>.EditStateService.NotifyRecordSaved();
        <span class="hljs-comment">// Render the component</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.InvokeAsync(<span class="hljs-keyword">this</span>.StateHasChanged);
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ResetToRecord</span>(<span class="hljs-params"></span>)</span>
        =&gt;  <span class="hljs-keyword">this</span>.Model.Populate(<span class="hljs-keyword">this</span>.Service.Record);

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Delete</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._isNew)
            <span class="hljs-keyword">this</span>._confirmDelete = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ConfirmDelete</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._confirmDelete)
        {
            <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.Service.DeleteRecordAsync();
            <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.DoExit();
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ConfirmExit</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">this</span>.EditStateService.ResetEditState();
        <span class="hljs-keyword">this</span>.SetPageExitCheck(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.DoExit();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">DoExit</span>(<span class="hljs-params">ModalResult result = <span class="hljs-literal">null</span></span>)</span>
    {
        result ??= ModalResult.OK();
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.IsModal)
            <span class="hljs-keyword">this</span>.Modal.Close(result);
        <span class="hljs-keyword">if</span> (ExitAction.HasDelegate)
            <span class="hljs-keyword">await</span> ExitAction.InvokeAsync();
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">this</span>.NavManager.NavigateTo(<span class="hljs-string">&quot;/&quot;</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetPageExitCheck</span>(<span class="hljs-params"><span class="hljs-built_in">bool</span> action</span>)</span>
        =&gt; _js.InvokeAsync&lt;<span class="hljs-built_in">bool</span>&gt;(<span class="hljs-string">&quot;cecblazor_setEditorExitCheck&quot;</span>, action);

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Dispose</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.EditContext != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">this</span>.EditContext.OnFieldChanged -= FieldChanged;
    }
}
</div></code></pre>
<h3 id="edit-state-management">Edit State Management</h3>
<p>The Edit state is managed through three classes:</p>
<ol>
<li><code>EditStateService</code> - a scoped State Service to hold information about a dirty form.</li>
<li><code>EditFormState</code> - a component within the <code>EditForm</code> Component that tracks the state of the fields within the <code>EditContext</code> model class and maintains the state of <code>EditStateService</code>.  On initialization it reloads any dirty data stored in <code>EditStateService</code>.</li>
<li><code>RouteViewManager</code> - a replace component for <code>RouteView</code> in <code>App</code>.  It injects <code>EditStateService</code> and loads a custom &quot;Are You Sure You want to Exit the Form&quot; form if <code>EditStateService</code> has a dirty form.</li>
</ol>
<p>There's also a Js script that's loaded in the base page <em>site.js</em>.</p>
<pre><code class="language-js"><div><span class="hljs-comment">// File: Blazr.SPA/wwwroot/site.js</span>
<span class="hljs-built_in">window</span>.cecblazor_setEditorExitCheck = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">show</span>) </span>{
    <span class="hljs-keyword">if</span> (show) {
        <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;beforeunload&quot;</span>, cecblazor_showExitDialog);
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">&quot;beforeunload&quot;</span>, cecblazor_showExitDialog);
    }
}

<span class="hljs-built_in">window</span>.cecblazor_showExitDialog = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
    event.preventDefault();
    event.returnValue = <span class="hljs-string">&quot;There are unsaved changes on this page.  Do you want to leave?&quot;</span>;
}
</div></code></pre>
<p>You can see the C# interface method in <code>EditRecordFormBase</code> above and being called in <code>ConfirmExit</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ConfirmExit</span>(<span class="hljs-params"></span>)</span>
{
    <span class="hljs-keyword">this</span>.EditStateService.ResetEditState();
    <span class="hljs-keyword">this</span>.SetPageExitCheck(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.DoExit();
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetPageExitCheck</span>(<span class="hljs-params"><span class="hljs-built_in">bool</span> action</span>)</span>
    =&gt; _js.InvokeAsync&lt;<span class="hljs-built_in">bool</span>&gt;(<span class="hljs-string">&quot;cecblazor_setEditorExitCheck&quot;</span>, action);
</div></code></pre>
<h2 id="implementing-forms">Implementing Forms</h2>
<h3 id="weatherforecastviewerform">WeatherForecastViewerForm</h3>
<p>The code for the <code>WeatherForecastViewerForm</code> is pretty simple.</p>
<ol>
<li>Inherit from <code>RecordFormBase</code> and set <code>TRecord</code> as <code>WeatherForecast</code>.</li>
<li>Get the <code>WeatherForecastViewService</code> and assign it to the base <code>Service</code> property.</li>
</ol>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastViewerForm</span> : <span class="hljs-title">RecordFormBase</span>&lt;<span class="hljs-title">WeatherForecast</span>&gt;
{
    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">private</span> WeatherForecastViewService ViewService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">override</span> Task <span class="hljs-title">OnInitializedAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">this</span>.Service = <span class="hljs-keyword">this</span>.ViewService;
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">base</span>.OnInitializedAsync();
    }
}
</div></code></pre>
<p>The majority of the code is component markup in the Razor file.</p>
<ol>
<li>There's no Html code, it's all components.  We'll look at UI components in detail on the next article.</li>
<li>The layout is based on Bootstrap grids.</li>
<li>Column size dictated control size.</li>
<li><code>UILoader</code> only loads it's content when we have a record to display.</li>
</ol>
<pre><code class="language-html"><div>@namespace Blazr.Database.Forms
@inherits RecordFormBase<span class="hljs-tag">&lt;<span class="hljs-name">WeatherForecast</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">UIContainer</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UIFormRow</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">UIColumn</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Weather Forecast Viewer<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">UIColumn</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UIFormRow</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">UIContainer</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">UILoader</span> <span class="hljs-attr">State</span>=<span class="hljs-string">&quot;this.LoadState&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UIContainer</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormViewControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Date&quot;</span> <span class="hljs-attr">Value</span>=<span class="hljs-string">&quot;@this.ViewService.Record.Date.LocalDateTime.ToShortDateString()&quot;</span> <span class="hljs-attr">IsRow</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ControlCols</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormViewControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Temperature <span class="hljs-symbol">&amp;deg;</span>C&quot;</span> <span class="hljs-attr">Value</span>=<span class="hljs-string">&quot;@this.ViewService.Record.TemperatureC.ToString()&quot;</span> <span class="hljs-attr">IsRow</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ControlCols</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormViewControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Temperature <span class="hljs-symbol">&amp;deg;</span>F&quot;</span> <span class="hljs-attr">Value</span>=<span class="hljs-string">&quot;@this.ViewService.Record.TemperatureF.ToString()&quot;</span> <span class="hljs-attr">IsRow</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ControlCols</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormViewControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Summary&quot;</span> <span class="hljs-attr">Value</span>=<span class="hljs-string">&quot;@this.ViewService.Record.Summary&quot;</span> <span class="hljs-attr">IsRow</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ControlCols</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UIContainer</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">UILoader</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">UIContainer</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UIFormRow</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">UIButtonColumn</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-secondary&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;this.Exit&quot;</span>&gt;</span>Exit<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">UIButtonColumn</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UIFormRow</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">UIContainer</span>&gt;</span>
</div></code></pre>
<h3 id="weatherforecasteditorform">WeatherForecastEditorForm</h3>
<p><code>WeatherForecastEditorForm</code> is similar to <code>WeatherForecastViewerForm</code>.</p>
<p>The code is again pretty simple.</p>
<ol>
<li>Inherit from <code>EditRecordFormBase</code> and set <code>TRecord</code> as <code>WeatherForecast</code> and <code>TEditRecord</code> as <code>EditWeatherForecast</code>.</li>
<li>Get the <code>WeatherForecastViewService</code> and assign it to the base <code>Service</code> property.</li>
</ol>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastEditorForm</span> : <span class="hljs-title">EditRecordFormBase</span>&lt;<span class="hljs-title">WeatherForecast</span>, <span class="hljs-title">EditWeatherForecast</span>&gt;
{

    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">private</span> WeatherForecastViewService ViewService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">override</span> Task <span class="hljs-title">OnInitializedAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-comment">//this.FormUrl = &quot;/Weather/Edit&quot;;</span>
        <span class="hljs-keyword">this</span>.Service = ViewService;
        <span class="hljs-keyword">await</span> LoadRecordAsync();
    }
}
</div></code></pre>
<p>The Razor file is shown below.  It's based on the standard Blazor EditForm with some additional controls.  The same comments made on the Viewer apply here.  In addition:</p>
<ol>
<li><code>InlineDialog</code> is a form locking control.  It's enabled by the <code>_isInlineDirty</code> property.  Go to the demo site and edit a record to see it in action. It's only enabled when the form isn't in a modal context.</li>
<li><code>EditFormState</code> is the control that tracks the form edit state.  It links with <code>InlineDialog</code> to control form locking.</li>
<li><code>ValidationFormState</code> is a custom validation control.</li>
<li>The buttons are tied to the boolean control properties to manage their state.</li>
</ol>
<p>The custom controls are covered in separate articles referenced in the Links section.</p>
<pre><code class="language-html"><div>@namespace Blazr.Database.Forms
@inherits EditRecordFormBase&lt;WeatherForecast, EditWeatherForecast&gt;

<span class="hljs-tag">&lt;<span class="hljs-name">InlineDialog</span> <span class="hljs-attr">Lock</span>=<span class="hljs-string">&quot;this._isInlineDirty&quot;</span> <span class="hljs-attr">Transparent</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">FormViewTitle</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Weather Forecast Editor<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">FormViewTitle</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">UILoader</span> <span class="hljs-attr">State</span>=<span class="hljs-string">&quot;this.LoadState&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">EditForm</span> <span class="hljs-attr">EditContext</span>=<span class="hljs-string">&quot;this.EditContext&quot;</span> <span class="hljs-attr">OnValidSubmit</span>=<span class="hljs-string">&quot;HandleValidSubmit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot; px-2 py-3&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">EditFormState</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ValidationFormState</span> <span class="hljs-attr">ValidStateChanged</span>=<span class="hljs-string">&quot;this.ValidStateChanged&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ValidationFormState</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">UIContainer</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">FormViewRow</span> <span class="hljs-attr">Title</span>=<span class="hljs-string">&quot;Unique ID&quot;</span> <span class="hljs-attr">Value</span>=<span class="hljs-string">&quot;@this.Model.ID.ToString()&quot;</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIFormRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">UIColumn</span> <span class="hljs-attr">MediumColumns</span>=<span class="hljs-string">&quot;6&quot;</span> <span class="hljs-attr">Columns</span>=<span class="hljs-string">12</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">FormEditControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Date&quot;</span> <span class="hljs-attr">ShowLabel</span>=<span class="hljs-string">&quot;true&quot;</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;this.Model.Date&quot;</span> <span class="hljs-attr">ControlType</span>=<span class="hljs-string">&quot;typeof(InputDate&lt;DateTimeOffset&gt;)&quot;</span> <span class="hljs-attr">IsRequired</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ShowValidation</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">HelperText</span>=<span class="hljs-string">&quot;Enter the Forecast Date&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">FormEditControl</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">UIColumn</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">UIColumn</span> <span class="hljs-attr">MediumColumns</span>=<span class="hljs-string">&quot;6&quot;</span> <span class="hljs-attr">Columns</span>=<span class="hljs-string">12</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">FormEditControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Temperature <span class="hljs-symbol">&amp;deg;</span>C&quot;</span> <span class="hljs-attr">ShowLabel</span>=<span class="hljs-string">&quot;true&quot;</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;this.Model.TemperatureC&quot;</span> <span class="hljs-attr">ControlType</span>=<span class="hljs-string">&quot;typeof(InputNumber&lt;int&gt;)&quot;</span> <span class="hljs-attr">IsRequired</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ShowValidation</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">HelperText</span>=<span class="hljs-string">&quot;Enter the Temperature&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">FormEditControl</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">UIColumn</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">UIFormRow</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIFormRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">UIColumn</span> <span class="hljs-attr">MediumColumns</span>=<span class="hljs-string">&quot;12&quot;</span> <span class="hljs-attr">Columns</span>=<span class="hljs-string">12</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">FormEditControl</span> <span class="hljs-attr">Label</span>=<span class="hljs-string">&quot;Summary&quot;</span> <span class="hljs-attr">ShowLabel</span>=<span class="hljs-string">&quot;true&quot;</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;this.Model.Summary&quot;</span> <span class="hljs-attr">IsRequired</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">ShowValidation</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">HelperText</span>=<span class="hljs-string">&quot;Summarise the Weather&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">FormEditControl</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">UIColumn</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">UIFormRow</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">UIContainer</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">FormEditButtons</span> <span class="hljs-attr">ContainerSize</span>=<span class="hljs-string">&quot;BootstrapSize.XLarge&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">Disabled</span>=<span class="hljs-string">&quot;this._deleteDisabled&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-outline-danger&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;() =&gt; Delete()&quot;</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;this._confirmDelete&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-danger&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;() =&gt; this.ConfirmDelete()&quot;</span>&gt;</span>Confirm Delete<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;this.IsDirty&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-outline-warning&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;() =&gt; this.ResetToRecord()&quot;</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">Disabled</span>=<span class="hljs-string">&quot;this._saveDisabled&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-success&quot;</span>&gt;</span>@this._saveButtonText<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;this.IsDirty&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-danger&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;() =&gt; this.ConfirmExit()&quot;</span>&gt;</span>Exit Without Saving<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">UIButton</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">Show</span>=<span class="hljs-string">&quot;!this.IsDirty&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-dark&quot;</span> <span class="hljs-attr">ClickEvent</span>=<span class="hljs-string">&quot;() =&gt; this.Exit()&quot;</span>&gt;</span>Exit<span class="hljs-tag">&lt;/<span class="hljs-name">UIButton</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">FormEditButtons</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">EditForm</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UILoader</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">InlineDialog</span>&gt;</span>
</div></code></pre>
<h2 id="routeview-implementations">RouteView Implementations</h2>
<p>The RouteView implementation of the viewer is shown below.</p>
<ol>
<li>Declares the <code>Route</code> with an ID <code>Parameter</code>.</li>
<li>Declares the form <code>WeatherForecastViewerForm</code>.</li>
<li>Passes the <code>ID</code> to the form and attaches a delegate to <code>ExitAction</code> which returns to the <em>fetchdata</em> view.</li>
</ol>
<pre><code class="language-html"><div>// WeatherViewer.razor
@page &quot;/weather/view/{ID:guid}&quot;
@namespace Blazr.Database.RouteViews

<span class="hljs-tag">&lt;<span class="hljs-name">WeatherForecastViewerForm</span> <span class="hljs-attr">ID</span>=<span class="hljs-string">&quot;this.ID&quot;</span> <span class="hljs-attr">ExitAction</span>=<span class="hljs-string">&quot;this.ExitToList&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">WeatherForecastViewerForm</span>&gt;</span>

@code {
    [Parameter] public Guid ID { get; set; }

    [Inject] public NavigationManager NavManager { get; set; }

    private void ExitToList()
        =&gt; this.NavManager.NavigateTo(&quot;/fetchdata&quot;);

}
</div></code></pre>
<p>The editor is exactly the same, but declares the form <code>WeatherForecastEditorForm</code>.</p>
<pre><code class="language-html"><div>// WeatherEditor.razor
@page &quot;/weather/edit/{ID:guid}&quot;
@namespace Blazr.Database.RouteViews

<span class="hljs-tag">&lt;<span class="hljs-name">WeatherForecastEditorForm</span> <span class="hljs-attr">ID</span>=<span class="hljs-string">&quot;this.ID&quot;</span> <span class="hljs-attr">ExitAction</span>=<span class="hljs-string">&quot;this.ExitToList&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">WeatherForecastEditorForm</span>&gt;</span>

@code {

    [Parameter] public Guid ID { get; set; }

    [Inject] public NavigationManager NavManager { get; set; }

    private void ExitToList()
        =&gt; this.NavManager.NavigateTo(&quot;/fetchdata&quot;);
}
</div></code></pre>
<h2 id="wrap-up">Wrap Up</h2>
<p>That wraps up this article.  We've shown how to build boilerplate code into base forms and how to implement viewer and editor forms.  We'll look in more detail at the list forms and how the viewer and editors are called in a separate article.<br>
Some key points to note:</p>
<ol>
<li>The Blazor Server and Blazor WASM code is the same.</li>
<li>Almost all the functionality is implemented in library components.  Most of the application code is Razor markup for the individual record fields.</li>
<li>The Razor files contains controls, not HTML.</li>
<li>Async in used through.</li>
</ol>
<p>If you're reading this article in the future, check the readme in the repository for the latest version of the article set.</p>
<h2 id="history">History</h2>
<ul>
<li>19-Sep-2020: Initial version.</li>
<li>17-Nov-2020: Major Blazor.CEC library changes.  Change to ViewManager from Router and new Component base implementation.</li>
<li>29-Mar-2021: Major updates to Services, project structure and data editing.</li>
<li>24-June-2021: revisions to data layers.</li>
<li>06-Aug-2012: revisions to reflect the project and library remodelling to the domain model.</li>
</ul>

        
        
    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2022</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
