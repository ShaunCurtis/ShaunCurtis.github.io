<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="How to build a single Blazor Application that runs in both WASM and Server Modes." >
<meta name="author" content="Shaun Curtis" >



<title>Blazor All In One - Multi SPA Hosting</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="953e93dd-c52f-425d-8b87-93b0d5fc40a4" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="953e93dd-c52f-425d-8b87-93b0d5fc40a4" >
<a class="dropdown-item" href="/articles/# Building-Blazor-List-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor List Components and the Notification Pattern
</a>
<a class="dropdown-item" href="/articles/A-Flexible-App.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Brick-By-Brick.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Brick By Brick
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/Policy-Based-Authorization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Policy Base Authorization in Blazor
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="31525866-e14b-4e11-9fed-b405e8f58244" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="31525866-e14b-4e11-9fed-b405e8f58244" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="e5ffeadf-e450-4950-89fa-3d56797c1429" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="e5ffeadf-e450-4950-89fa-3d56797c1429" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="e149647e-58c6-4a1f-bb42-0d06e2c04bed" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="e149647e-58c6-4a1f-bb42-0d06e2c04bed" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="3fd093e6-bbdf-4b2b-94c6-f0dd116c88c8" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Posts</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="3fd093e6-bbdf-4b2b-94c6-f0dd116c88c8" >
<a class="dropdown-item" href="/posts/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/posts/Blazor-Bootstrap-Toaster.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Bootstrap Toaster
</a>
<a class="dropdown-item" href="/posts/Blazor-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Services
</a>
<a class="dropdown-item" href="/posts/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/posts/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/posts/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/posts/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Notification Service Pattern
</a>
<a class="dropdown-item" href="/posts/The-Blazor-WASM-Hosted-Project.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor WASM Hosted Project
</a>
<a class="dropdown-item" href="/posts/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 26-02-2021 >
<div>Published: 26-02-2021</div>
<div>Last Updated: 04-04-2021</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#code-repository">Code Repository</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#the-solution-and-projects">The Solution and Projects</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#blazor-project-changes">Blazor Project Changes</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#mainlayout">MainLayout</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#navmenu">NavMenu</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#fetchdatarazor">FetchData.razor</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#blazorweb"><a href="http://Blazor.Web">Blazor.Web</a></a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#indexcshtml">Index.cshtml</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#startupcs">Startup.cs</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#run-the-application">Run the Application</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#adding-a-dataservice">Adding a DataService</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastcs">WeatherForecast.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#iweatherforecastservicecs">IWeatherForecastService.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastserverservicecs">WeatherForecastServerService.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastapiservicecs">WeatherForecastAPIService.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastcontrollercs">WeatherForecastController.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#blazor-project-programcs">Blazor Project Program.cs</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#blazorweb-startupcs"><a href="http://Blazor.Web">Blazor.Web</a> Startup.cs</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#building-and-run-the-project">Building and Run the project</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#how-does-it-work">How Does It Work?</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#wrap-up">Wrap Up</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>Blazor All In One - Multi SPA Hosting</h1>
<div>How to build a single Blazor Application that runs in both WASM and Server Modes.</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <p>This article shows how to build a single Blazor application that runs in both WASM and Server Modes.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-AllinOne/Screenshot.png" alt="screenshot"></p>
<h2 id="code-repository">Code Repository</h2>
<p>The Code repository for the article is <a href="https://github.com/ShaunCurtis/AllinOne">here - https://github.com/ShaunCurtis/AllinOne </a></p>
<h2 id="the-solution-and-projects">The Solution and Projects</h2>
<p>Create a new solution called <strong>Blazor</strong> using the Blazor WebAssembly template.  Don't choose to host it on Aspnetcore.  You will get a single project called <strong>Blazor</strong>.</p>
<p>Now add a second project to the solution using the <em><a href="http://ASP.NET">ASP.NET</a> Core Web App</em> template.  Call it <strong><a href="http://Blazor.Web">Blazor.Web</a></strong>.  Set it as the startup project.</p>
<p>The solution should now look like this:</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-AllinOne/Base-Projects.png" alt="Solution"></p>
<h2 id="blazor-project-changes">Blazor Project Changes</h2>
<p>The solution runs the WASM context in a sub-directory on the web site.  To get this working there are a few modifications that need to be made to the <em>Blazor</em> project.</p>
<ol>
<li>Move the contents of wwwroot to <em><a href="http://Blazor.Web">Blazor.Web</a></em> and delete everything in <em>wwwroot</em>.</li>
<li>Add a <code>StaticWebAssetBasePath</code> entry to the project file set to <code>wasm</code>.  This is case sensitive in the context in which it is used, so stick to small letters.</li>
<li>Add the necessary packages.</li>
</ol>
<p>The project file should look like this:</p>
<pre><code class="language-xml"><div><span class="hljs-tag">&lt;<span class="hljs-name">Project</span> <span class="hljs-attr">Sdk</span>=<span class="hljs-string">&quot;Microsoft.NET.Sdk.BlazorWebAssembly&quot;</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">StaticWebAssetBasePath</span>&gt;</span>wasm<span class="hljs-tag">&lt;/<span class="hljs-name">StaticWebAssetBasePath</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>net5.0<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Microsoft.AspNetCore.Components.WebAssembly&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;5.0.4&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Microsoft.AspNetCore.Components.WebAssembly.DevServer&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;5.0.4&quot;</span> <span class="hljs-attr">PrivateAssets</span>=<span class="hljs-string">&quot;all&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;System.Net.Http.Json&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;5.0.0&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Folder</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;wwwroot\&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">Project</span>&gt;</span>
</div></code></pre>
<h3 id="mainlayout">MainLayout</h3>
<p><code>MainLayout</code> needs to be modified to handle both contexts.  The solution changes the colour scheme for each context.  WASM  <em>Teal</em> and Server <em>Steel</em>.</p>
<pre><code class="language-csharp"><div>@inherits LayoutComponentBase
&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;page&quot;</span>&gt;
    @*change <span class="hljs-keyword">class</span>*@
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;@_<span class="hljs-title">sidebarCss</span>&quot;&gt;
        &lt;<span class="hljs-title">NavMenu</span> /&gt;
    &lt;/<span class="hljs-title">div</span>&gt;
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">main</span>&quot;&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">top</span>-<span class="hljs-title">row</span> <span class="hljs-title">px</span>-4&quot;&gt;
            &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>=&quot;<span class="hljs-title">https</span>://<span class="hljs-title">docs.microsoft.com</span>/<span class="hljs-title">aspnet</span>/&quot; <span class="hljs-title">target</span>=&quot;_<span class="hljs-title">blank</span>&quot;&gt;<span class="hljs-title">About</span>&lt;/<span class="hljs-title">a</span>&gt;
        &lt;/<span class="hljs-title">div</span>&gt;
        &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>=&quot;<span class="hljs-title">content</span> <span class="hljs-title">px</span>-4&quot;&gt;
            @<span class="hljs-title">Body</span>
        &lt;/<span class="hljs-title">div</span>&gt;
    &lt;/<span class="hljs-title">div</span>&gt;
&lt;/<span class="hljs-title">div</span>&gt;

@<span class="hljs-title">code</span> {
    [<span class="hljs-meta">Inject</span>] NavigationManager NavManager { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> _isWasm =&gt; NavManager?.Uri.Contains(<span class="hljs-string">&quot;wasm&quot;</span>, StringComparison.CurrentCultureIgnoreCase) ?? <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _sidebarCss =&gt; _isWasm ? <span class="hljs-string">&quot;sidebar sidebar-teal&quot;</span> : <span class="hljs-string">&quot;sidebar sidebar-steel&quot;</span>;
}
</div></code></pre>
<p>Add the following Css styles to the component Css file below <code>.sidebar</code>.</p>
<pre><code class="language-css"><div><span class="hljs-selector-class">.sidebar</span> {
    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">180deg</span>, rgb(<span class="hljs-number">5</span>, <span class="hljs-number">39</span>, <span class="hljs-number">103</span>) <span class="hljs-number">0%</span>, <span class="hljs-number">#3a0647</span> <span class="hljs-number">70%</span>);
}

<span class="hljs-comment">/* Added Styles*/</span>
<span class="hljs-selector-class">.sidebar-teal</span> {
    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">180deg</span>, rgb(<span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">128</span>) <span class="hljs-number">0%</span>, <span class="hljs-built_in">rgb</span>(<span class="hljs-number">0</span>,<span class="hljs-number">96</span>,<span class="hljs-number">192</span>) <span class="hljs-number">70%</span>);
}

<span class="hljs-selector-class">.sidebar-steel</span> {
    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">180deg</span>, #<span class="hljs-number">2</span>a3f4f <span class="hljs-number">0%</span>, #<span class="hljs-number">446680</span> <span class="hljs-number">70%</span>);
}
<span class="hljs-comment">/* End Added Styles*/</span>
</div></code></pre>
<h3 id="navmenu">NavMenu</h3>
<p>Add code and markup - it adds a link to switch between contexts.</p>
<pre><code class="language-csharp"><div>&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;top-row pl-4 navbar navbar-dark&quot;</span>&gt;
    @*Change title*@
    &lt;a <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;navbar-brand&quot;</span> href=<span class="hljs-string">&quot;&quot;</span>&gt;Blazor&lt;/a&gt;
    &lt;button <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;navbar-toggler&quot;</span> @onclick=<span class="hljs-string">&quot;ToggleNavMenu&quot;</span>&gt;
        &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;navbar-toggler-icon&quot;</span>&gt;&lt;/span&gt;
    &lt;/button&gt;
&lt;/div&gt;

&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;@NavMenuCssClass&quot;</span> @onclick=<span class="hljs-string">&quot;ToggleNavMenu&quot;</span>&gt;
    &lt;ul <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav flex-column&quot;</span>&gt;
        @*Add links between contexts*@
        &lt;li <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-item px-3&quot;</span>&gt;
                &lt;NavLink <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;@_otherContextUrl&quot;</span> Match=<span class="hljs-string">&quot;NavLinkMatch.All&quot;</span>&gt;
                    &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;oi oi-home&quot;</span> aria-hidden=<span class="hljs-string">&quot;true&quot;</span>&gt;&lt;/span&gt; @_otherContextLinkName
                &lt;/NavLink&gt;
        &lt;/li&gt;
        &lt;li <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-item px-3&quot;</span>&gt;
            &lt;NavLink <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;&quot;</span> Match=<span class="hljs-string">&quot;NavLinkMatch.All&quot;</span>&gt;
                &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;oi oi-home&quot;</span> aria-hidden=<span class="hljs-string">&quot;true&quot;</span>&gt;&lt;/span&gt; Home
            &lt;/NavLink&gt;
        &lt;/li&gt;
        &lt;li <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-item px-3&quot;</span>&gt;
            &lt;NavLink <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;counter&quot;</span>&gt;
                &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;oi oi-plus&quot;</span> aria-hidden=<span class="hljs-string">&quot;true&quot;</span>&gt;&lt;/span&gt; Counter
            &lt;/NavLink&gt;
        &lt;/li&gt;
        &lt;li <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-item px-3&quot;</span>&gt;
            &lt;NavLink <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;fetchdata&quot;</span>&gt;
                &lt;span <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;oi oi-list-rich&quot;</span> aria-hidden=<span class="hljs-string">&quot;true&quot;</span>&gt;&lt;/span&gt; Fetch data
            &lt;/NavLink&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;

@code {
    [<span class="hljs-meta">Inject</span>] NavigationManager NavManager { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> _isWasm =&gt; NavManager?.Uri.Contains(<span class="hljs-string">&quot;wasm&quot;</span>, StringComparison.CurrentCultureIgnoreCase) ?? <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _otherContextUrl =&gt; _isWasm ? <span class="hljs-string">&quot;/&quot;</span> : <span class="hljs-string">&quot;/wasm&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _otherContextLinkName =&gt; _isWasm ? <span class="hljs-string">&quot;Server Home&quot;</span> : <span class="hljs-string">&quot;WASM Home&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _title =&gt; _isWasm ? <span class="hljs-string">&quot;AllinOne WASM&quot;</span> : <span class="hljs-string">&quot;AllinOne Server&quot;</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> collapseNavMenu = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> NavMenuCssClass =&gt; collapseNavMenu ? <span class="hljs-string">&quot;collapse&quot;</span> : <span class="hljs-literal">null</span>;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ToggleNavMenu</span>(<span class="hljs-params"></span>)</span>
    {
        collapseNavMenu = !collapseNavMenu;
    }
}
</div></code></pre>
<h3 id="fetchdatarazor">FetchData.razor</h3>
<p>Update the Url for getting forecasts by adding a <code>/</code> at the start, the file is now in the root and not in <code>wasm</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">OnInitializedAsync</span>(<span class="hljs-params"></span>)</span>
{
    forecasts = <span class="hljs-keyword">await</span> Http.GetFromJsonAsync&lt;WeatherForecast[]&gt;(<span class="hljs-string">&quot;/sample-data/weather.json&quot;</span>);
}
</div></code></pre>
<h2 id="blazorweb"><a href="http://Blazor.Web">Blazor.Web</a></h2>
<p>Update the project file:</p>
<pre><code class="language-xml"><div><span class="hljs-tag">&lt;<span class="hljs-name">Project</span> <span class="hljs-attr">Sdk</span>=<span class="hljs-string">&quot;Microsoft.NET.Sdk.Web&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>net5.0<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Microsoft.AspNetCore.Components.WebAssembly.Server&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;5.0.3&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ProjectReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;..\Blazor\Blazor.csproj&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Project</span>&gt;</span>
</div></code></pre>
<p>Add a Razor Page to <em>Pages</em> called <em>WASM.cshtml</em> - the launch page for the WASM SPA.</p>
<pre><code class="language-html"><div>@page &quot;/wasm&quot;
@{
    Layout = null;
}

<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Blazor<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    @*Change base*@
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/wasm/&quot;</span> /&gt;</span>
    @*Update Link hrefs*@
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/css/bootstrap/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/css/app.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/wasm/Blazor.styles.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;blazor-error-ui&quot;</span>&gt;</span>
        An unhandled error has occurred.
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;reload&quot;</span>&gt;</span>Reload<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dismiss&quot;</span>&gt;</span>🗙<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    @*Update js sources *@
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/wasm/_framework/blazor.webassembly.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Add a second Razor Page to <em>Pages</em> called <em>Server.cshtml</em> - the launch page for the Servr SPA.</p>
<pre><code class="language-csharp"><div>@page <span class="hljs-string">&quot;/&quot;</span>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = <span class="hljs-literal">null</span>;
}

&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;
    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span> /&gt;
    &lt;title&gt;Blazor&lt;/title&gt;
    &lt;<span class="hljs-keyword">base</span> href=<span class="hljs-string">&quot;/&quot;</span> /&gt;
    &lt;link href=<span class="hljs-string">&quot;/css/bootstrap/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;
    &lt;link href=<span class="hljs-string">&quot;/css/site.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;
    &lt;link href=<span class="hljs-string">&quot;/wasm/Blazor.styles.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;component type=<span class="hljs-string">&quot;typeof(Blazor.App)&quot;</span> render-mode=<span class="hljs-string">&quot;ServerPrerendered&quot;</span> /&gt;

    &lt;div id=<span class="hljs-string">&quot;blazor-error-ui&quot;</span>&gt;
        &lt;environment include=<span class="hljs-string">&quot;Staging,Production&quot;</span>&gt;
            An error has occurred. This application may no longer respond until reloaded.
        &lt;/environment&gt;
        &lt;environment include=<span class="hljs-string">&quot;Development&quot;</span>&gt;
            An unhandled exception has occurred. See browser dev tools <span class="hljs-keyword">for</span> details.
        &lt;/environment&gt;
        &lt;a href=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;reload&quot;</span>&gt;Reload&lt;/a&gt;
        &lt;a <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;dismiss&quot;</span>&gt;🗙&lt;/a&gt;
    &lt;/div&gt;

    &lt;script src=<span class="hljs-string">&quot;_framework/blazor.server.js&quot;</span>&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></pre>
<h3 id="indexcshtml">Index.cshtml</h3>
<p>Update the <code>@page</code> directive to <code>@page &quot;/index&quot;</code>.</p>
<h3 id="startupcs">Startup.cs</h3>
<p>Update <code>Startup</code> to handle WASM and Server middleware paths.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Startup</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Startup</span>(<span class="hljs-params">IConfiguration configuration</span>)</span>
    {
        Configuration = configuration;
    }

    <span class="hljs-keyword">public</span> IConfiguration Configuration { <span class="hljs-keyword">get</span>; }

    <span class="hljs-comment">// This method gets called by the runtime. Use this method to add services to the container.</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span>
    {
        services.AddRazorPages();
        services.AddServerSideBlazor();

        <span class="hljs-comment">// Server Side Blazor doesn&#x27;t register HttpClient by default</span>
        <span class="hljs-comment">// Thanks to Robin Sue - Suchiman https://github.com/Suchiman/BlazorDualMode</span>
        <span class="hljs-keyword">if</span> (!services.Any(x =&gt; x.ServiceType == <span class="hljs-keyword">typeof</span>(HttpClient)))
        {
            <span class="hljs-comment">// Setup HttpClient for server side in a client side compatible fashion</span>
            services.AddScoped&lt;HttpClient&gt;(s =&gt;
            {
                <span class="hljs-comment">// Creating the URI helper needs to wait until the JS Runtime is initialized, so defer it.</span>
                <span class="hljs-keyword">var</span> uriHelper = s.GetRequiredService&lt;NavigationManager&gt;();
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> HttpClient
                {
                    BaseAddress = <span class="hljs-keyword">new</span> Uri(uriHelper.BaseUri)
                };
            });
        }
    }

    <span class="hljs-comment">// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IApplicationBuilder app, IWebHostEnvironment env</span>)</span>
    {
        <span class="hljs-keyword">if</span> (env.IsDevelopment())
        {
            app.UseDeveloperExceptionPage();
        }
        <span class="hljs-keyword">else</span>
        {
            app.UseExceptionHandler(<span class="hljs-string">&quot;/Error&quot;</span>);
            <span class="hljs-comment">// The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span>
            app.UseHsts();
        }

        app.UseHttpsRedirection();
        app.UseStaticFiles();

        app.MapWhen(ctx =&gt; ctx.Request.Path.StartsWithSegments(<span class="hljs-string">&quot;/wasm&quot;</span>), app1 =&gt;
        {
            app1.UseBlazorFrameworkFiles(<span class="hljs-string">&quot;/wasm&quot;</span>);
            app1.UseRouting();
            app1.UseEndpoints(endpoints =&gt;
            {
                endpoints.MapFallbackToPage(<span class="hljs-string">&quot;/wasm/{*path:nonfile}&quot;</span>, <span class="hljs-string">&quot;/wasm&quot;</span>);
            });
        });

        app.UseRouting();

        app.UseEndpoints(endpoints =&gt;
        {
            endpoints.MapControllers();
            endpoints.MapBlazorHub();
            endpoints.MapRazorPages();
            endpoints.MapFallbackToPage(<span class="hljs-string">&quot;/Server&quot;</span>);
        });
    }
}
</div></code></pre>
<h2 id="run-the-application">Run the Application</h2>
<p>The application should now run.  It will start in the Server context.  Switch to the WASM context via the link in the left menu.  You should see the the colour change as you switch between contexts.</p>
<h2 id="adding-a-dataservice">Adding a DataService</h2>
<p>While the above configuation works, it needs some demo code to show how it handles more conventional data services.  We'll modify the solution to work with a very basic data services to show the DI and interface concepts that should be used.</p>
<p>Add <em>Data</em> and <em>Services</em> folders to the <em>Blazor</em> project.</p>
<h3 id="weatherforecastcs">WeatherForecast.cs</h3>
<p>Add a <code>WeatherForecast</code> class to <em>Data</em>.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecast</span>
{
    <span class="hljs-keyword">public</span> DateTime Date { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> TemperatureC { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Summary { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> TemperatureF =&gt; <span class="hljs-number">32</span> + (<span class="hljs-keyword">int</span>)(TemperatureC / <span class="hljs-number">0.5556</span>);
}
</div></code></pre>
<h3 id="iweatherforecastservicecs">IWeatherForecastService.cs</h3>
<p>Add a <code>IWeatherForecastService</code> interface to <em>Services</em>.</p>
<pre><code class="language-csharp"><div>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IWeatherForecastService</span>
    {
        <span class="hljs-keyword">public</span> Task&lt;List&lt;WeatherForecast&gt;&gt; GetRecordsAsync();
    }
</div></code></pre>
<h3 id="weatherforecastserverservicecs">WeatherForecastServerService.cs</h3>
<p>Add a <code>WeatherForecastServerService</code> class to <em>Services</em>.  Normally this would interface to a database, but here we're just creating a set of dummy records.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastServerService</span> : <span class="hljs-title">IWeatherForecastService</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span>[] Summaries = <span class="hljs-keyword">new</span>[]
    {
        <span class="hljs-string">&quot;Freezing&quot;</span>, <span class="hljs-string">&quot;Bracing&quot;</span>, <span class="hljs-string">&quot;Chilly&quot;</span>, <span class="hljs-string">&quot;Cool&quot;</span>, <span class="hljs-string">&quot;Mild&quot;</span>, <span class="hljs-string">&quot;Warm&quot;</span>, <span class="hljs-string">&quot;Balmy&quot;</span>, <span class="hljs-string">&quot;Hot&quot;</span>, <span class="hljs-string">&quot;Sweltering&quot;</span>, <span class="hljs-string">&quot;Scorching&quot;</span>
    };

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">WeatherForecast</span>&gt; records</span> = <span class="hljs-keyword">new</span> List&lt;WeatherForecast&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WeatherForecastServerService</span>(<span class="hljs-params"></span>)</span>
        =&gt; <span class="hljs-keyword">this</span>.GetForecasts();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetForecasts</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">var</span> rng = <span class="hljs-keyword">new</span> Random();
        records = Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>).Select(index =&gt; <span class="hljs-keyword">new</span> WeatherForecast
        {
            Date = DateTime.Now.AddDays(index),
            TemperatureC = rng.Next(<span class="hljs-number">-20</span>, <span class="hljs-number">55</span>),
            Summary = Summaries[rng.Next(Summaries.Length)]
        }).ToList();
    }

    <span class="hljs-keyword">public</span> Task&lt;List&lt;WeatherForecast&gt;&gt; GetRecordsAsync()
        =&gt; Task.FromResult(<span class="hljs-keyword">this</span>.records);
}
</div></code></pre>
<h3 id="weatherforecastapiservicecs">WeatherForecastAPIService.cs</h3>
<p>Add a <code>WeatherForecastAPIService</code> class to <em>Services</em>.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastAPIService</span> : <span class="hljs-title">IWeatherForecastService</span>
{
    <span class="hljs-keyword">protected</span> HttpClient HttpClient { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WeatherForecastAPIService</span>(<span class="hljs-params">HttpClient httpClient</span>)</span>
        =&gt; <span class="hljs-keyword">this</span>.HttpClient = httpClient;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;List&lt;WeatherForecast&gt;&gt; GetRecordsAsync()
        =&gt; <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.HttpClient.GetFromJsonAsync&lt;List&lt;WeatherForecast&gt;&gt;(<span class="hljs-string">$&quot;/api/weatherforecast/list&quot;</span>);
}
</div></code></pre>
<h3 id="weatherforecastcontrollercs">WeatherForecastController.cs</h3>
<p>Finally add a <code>WeatherForecastController</code> class to the <em><a href="http://Blazor.Web">Blazor.Web</a></em> project in a <em>Controller</em> folder.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> Blazor.Data;
<span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
<span class="hljs-keyword">using</span> MVC = Microsoft.AspNetCore.Mvc;
<span class="hljs-keyword">using</span> Blazor.Services;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Blazor.Web.APIControllers</span>
{
    [<span class="hljs-meta">ApiController</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastController</span> : <span class="hljs-title">ControllerBase</span>
    {
        <span class="hljs-keyword">protected</span> IWeatherForecastService DataService { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WeatherForecastController</span>(<span class="hljs-params">IWeatherForecastService dataService</span>)</span>
            =&gt; <span class="hljs-keyword">this</span>.DataService = dataService;

        [<span class="hljs-meta">MVC.Route(<span class="hljs-meta-string">&quot;/api/weatherforecast/list&quot;</span>)</span>]
        [<span class="hljs-meta">HttpGet</span>]
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;List&lt;WeatherForecast&gt;&gt; GetList() =&gt; <span class="hljs-keyword">await</span> DataService.GetRecordsAsync();
    }
}
</div></code></pre>
<h3 id="blazor-project-programcs">Blazor Project Program.cs</h3>
<p>Add the API service to <em>Program.cs</em> in the <em>Blazor</em> project, declaring it through it's <code>IWeatherForecastService</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)</span>
    {
        <span class="hljs-keyword">var</span> builder = WebAssemblyHostBuilder.CreateDefault(args);
        builder.RootComponents.Add&lt;App&gt;(<span class="hljs-string">&quot;#app&quot;</span>);

        builder.Services.AddScoped(sp =&gt; <span class="hljs-keyword">new</span> HttpClient { BaseAddress = <span class="hljs-keyword">new</span> Uri(builder.HostEnvironment.BaseAddress) });
        builder.Services.AddScoped&lt;IWeatherForecastService, WeatherForecastAPIService&gt;();

        <span class="hljs-keyword">await</span> builder.Build().RunAsync();
    }
}
</div></code></pre>
<h3 id="blazorweb-startupcs"><a href="http://Blazor.Web">Blazor.Web</a> Startup.cs</h3>
<p>Add the server service to <em>Startup.cs</em> in the <em><a href="http://Blazor.Web">Blazor.Web</a></em> project, again through it's <code>IWeatherForecastService</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ConfigureServices</span>(<span class="hljs-params">IServiceCollection services</span>)</span>
{
    services.AddRazorPages();
    services.AddServerSideBlazor();
    services.AddScoped&lt;IWeatherForecastService, WeatherForecastServerService&gt;();
    .....
}
</div></code></pre>
<h2 id="building-and-run-the-project">Building and Run the project</h2>
<p>The solution should now build and run.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-AllinOne/Blazor-Project.png" alt="Blazor Project"></p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-AllinOne/Blazor-Web-Project.png" alt="Blazor.Web Project"></p>
<h2 id="how-does-it-work">How Does It Work?</h2>
<p>Fundimentally, the difference between a Blazor Server and a Blazor WASM Application is the context in which it's run.  In the solution all SPA code is built in the Web Assembly project, and used by both the WASM and Server contexts.  There's no &quot;shared&quot; code library code, because it's exactly the same front end code with the same entrypoint - App.razor.  The different between the two contexts, is the provider of the backend services.</p>
<p>The web assembly project is declared <code>&lt;Project Sdk=&quot;Microsoft.NET.Sdk.BlazorWebAssembly&quot;&gt;</code>.  It builds both a standard <em>Blazor.dll</em> file and the WASM specific code including the Web Assembly &quot;boot configuration file&quot; <em>blazor.boot.json</em>.</p>
<p>In the web assembly context, the initial page loads <em>blazor.webassembly.js</em>.  This loads <em>blazor.boot.json</em> which tells <em>blazor.webassembly.js</em> how to &quot;boot&quot; the Web assembly code in the browser.  It runs <code>Program</code> which builds the <code>WebAssemblyHost</code>, loads the defined services, and starts the <code>Renderer</code> which replaces the <em>app</em> html element with the root component specified in <code>Program</code>.  This loads the router, which reads the Url, gets the appropiate component, loads it into the specified layout, and begins the rendering process.  SPA up and running.</p>
<p>In the Server context, the server side code picks up the component reference in the initial load page and statically renders it.  It passes the rendered page to the client.  This loads and runs <code>blazor.server.js</code>, which calls back to the server SignalR Hub and gets the dynamically rendered app root component.  SPA up and running.  The services container and renderer are in the Blazor Hub - started by calling <code>services.AddServerSideBlazor()</code> in Startup when the web server starts.</p>
<p>The data services we implemented demonstrate Dependancy injection and interfaces.  The UI components - in our case <code>FetchData</code> consume the <code>IWeatherForcastService</code> service registered in Services.  In the WASM context, the services container starts <code>WeatherForecastAPIService</code>, while in the Server context, the services container starts <code>WeatherForecastServerService</code>.  Two different services, conforming to the same interface and consumed by the UI components using the interface.  The UI components don't care which service they consume, it just needs to implement <code>IWeatherForcastService</code>.</p>
<h2 id="wrap-up">Wrap Up</h2>
<p>Hopefully this article has provided an insight into how Blazor SPAs work and the real differences between a Server and WASM Blazor SPA.</p>
<p>If you are reading this well into the future, the most recent version of this article will be <a href="https://shauncurtis.github.io/articles/Blazor-AllinOne.html">here</a>.</p>

    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2022</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
