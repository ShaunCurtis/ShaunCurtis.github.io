<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="This article describes how to build a Blazor App from the standard AspNetCore Web template." >
<meta name="author" content="Shaun Curtis" >



<title>Building a Blazor App from Scratch</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="4a93f05c-3731-4115-b997-e26de89ec222" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="4a93f05c-3731-4115-b997-e26de89ec222" >
<a class="dropdown-item" href="/articles/A-Flexible-App.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Brick-By-Brick.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Brick By Brick
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/Building-Blazor-List-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor List Components and the Notification Pattern
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/Policy-Based-Authorization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Policy Base Authorization in Blazor
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
<a class="dropdown-item" href="/articles/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="f8d2993e-6749-4cec-acaf-4a95efd516a7" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="f8d2993e-6749-4cec-acaf-4a95efd516a7" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="9cc1a739-13cf-431e-acfd-c7be97ef056f" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Building Blazor Applications</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="9cc1a739-13cf-431e-acfd-c7be97ef056f" >
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Bootstrap-Toaster.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Bootstrap Toaster
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Blazor-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Services
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-A-Blazor-AutoComplete-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Blazor Autocomplete Control
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-Wrapper-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Wrapper Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Leaner-Meaner-Greener-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Leaner Meaner Greener Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Notification Service Pattern
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Rethinking-The-Repository-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Rethinking The Repository Pattern
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/The-Blazor-WASM-Hosted-Project.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor WASM Hosted Project
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Whats-Wrong-with-my-Component-Design.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Whats Wrong With My Component Design
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/The-Blazor-Component" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor Applications\The Blazor Component
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="238d9796-38c1-43a3-9a7f-7f71d5547c07" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="238d9796-38c1-43a3-9a7f-7f71d5547c07" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="809f91bc-dc0b-49d9-8b9a-e0cb69dec1cb" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="809f91bc-dc0b-49d9-8b9a-e0cb69dec1cb" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 04-01-2022 >
<div>Published: 04-01-2022</div>
<div>Last Updated: 04-01-2022</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#prerequesites">Prerequesites</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#code-repository">Code Repository</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#building-the-project">Building the Project</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#adding-a-blazor-component-to-a-razor-page">Adding a Blazor Component to a Razor Page</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#configuring-the-server-to-run-the-blazor-services">Configuring the Server to run the Blazor Services</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#building-a-blazor-spa">Building a Blazor SPA</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#section-summary">Section Summary</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#building-a-full-blazor-server-app">Building a Full Blazor Server App</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#adding-files-from-the-repo">Adding files from the Repo</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#app-component">App Component</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#routing">Routing</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#razor-server-side-pages">Razor Server-Side Pages</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#navigation-changes">Navigation Changes</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#web-changes">Web Changes</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#section-summary-1">Section Summary</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#setting-the-blazor-app-as-default">Setting the Blazor App as Default</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#navigation-within-a-blazor-app">Navigation within a Blazor App</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#summary">Summary</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>Building a Blazor App from Scratch</h1>
<div>This article describes how to build a Blazor App from the standard AspNetCore Web template.</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <p>In this article we'll build a Blazor Server Application brick-by-brick from the standard AspNetCore Web Application template.</p>
<p>The purpose of this article is a practical lesson in what Blazor really is and how you can start using it.  It should help you understand Blazor more quickly than simply deploying the template and playing with it.</p>
<p>While I'm a firm advocate of Visual Studio, we use Visual Studio code for this exercise to get a bit closer to the coal face.</p>
<h2 id="prerequesites">Prerequesites</h2>
<ul>
<li>Visual Studio Code</li>
<li>Net6.0 SDK</li>
</ul>
<blockquote>
<p>To keep things simple all the code and components are in a single namespace <strong>Blazr</strong>.</p>
</blockquote>
<h2 id="code-repository">Code Repository</h2>
<p>You can find all the code in the <a href="https://github.com/ShaunCurtis/BlazrServer">BlazrServer</a> Github Repository.</p>
<h2 id="building-the-project">Building the Project</h2>
<ol>
<li>
<p>Create a <em>Repos</em> folder in <em>Documents</em> (if you don't already have one).</p>
</li>
<li>
<p>Create a <em>Repos/BlazorServer</em> folder.</p>
</li>
<li>
<p>Open Visual Studio Code on the folder.</p>
</li>
<li>
<p><code>Ctl + '</code> to open the terminal.</p>
</li>
</ol>
<p>We're ready to deploy a template to the current folder.  But which one?</p>
<pre><code><code><div>PS C:\Users\shaun\source\repos\BlazrServer &gt; dotnet new --list
</div></code></code></pre>
<p>Will list all the installed templates.</p>
<p>We're after:</p>
<pre><code><code><div>ASP.NET Core Web App                          webapp,razor         [C#]        Web/MVC/Razor Pages
</div></code></code></pre>
<p>To use this:</p>
<pre><code><code><div>PS &gt; dotnet new razor
</div></code></code></pre>
<p>And we get:</p>
<pre><code><code><div>The template &quot;ASP.NET Core Web App&quot; was created successfully.
This template contains technologies from parties other than Microsoft, see https://aka.ms/aspnetcore/6.0-third-party-notices for details.

Processing post-creation actions...
Running 'dotnet restore' on C:\Users\shaun\source\repos\BlazorServer\BlazorServer.csproj...
  Determining projects to restore...
  Restored C:\Users\shaun\source\repos\BlazorServer\BlazorServer.csproj (in 90 ms).
Restore succeeded.
</div></code></code></pre>
<p>A set of folders and files deployed into the directory.</p>
<p>At this point we can:</p>
<pre><code><code><div>PS &gt; dotnet watch run debug
</div></code></code></pre>
<p>to get this:</p>
<pre><code><code><div>PS C:\Users\shaun\source\repos\BlazorServer&gt; dotnet watch run debug
watch : Started
Building...
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: https://localhost:7280
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5280
info: Microsoft.Hostingetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\Users\shaun\source\repos\BlazorServer\
</div></code></code></pre>
<p>And our site.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Base-Template-Run.png" alt="Base Template"></p>
<p>Make a change to <em>Index.cshtml</em></p>
<pre><code><code><div>    &lt;h1 class=&quot;display-4&quot;&gt;Welcome To my Nascient Blazor App&lt;/h1&gt;
</div></code></code></pre>
<p>and save it.  We get:</p>
<pre><code><code><div>watch : Exited
watch : File changed: C:\Users\shaun\source\repos\BlazorServer\Pages\Index.cshtml
watch : Started
Building...
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: https://localhost:7280
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5280
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: C:\Users\shaun\source\repos\BlazorServer\
</div></code></code></pre>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Base-modified-Template-Run.png" alt="Base Template"></p>
<p>Hot reload is working. We have a running Razor web application.</p>
<p>To wrap up this section, let's take a quick look at <code>Program</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// Initialise the WebApplication Builder</span>
<span class="hljs-keyword">var</span> builder = WebApplication.CreateBuilder(args);

<span class="hljs-comment">// Add services to the container.</span>
builder.Services.AddRazorPages();

<span class="hljs-comment">// Build the App from the builder</span>
<span class="hljs-keyword">var</span> app = builder.Build();

<span class="hljs-comment">// Configure the HTTP request pipeline.</span>
<span class="hljs-keyword">if</span> (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler(<span class="hljs-string">&quot;/Error&quot;</span>);
    app.UseHsts();
}
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();
app.MapRazorPages();

<span class="hljs-comment">// Run the Application</span>
app.Run();
</div></code></pre>
<p>This:</p>
<ol>
<li>Creates an instance of the <code>WebApplicationBuilder</code> class.</li>
<li>Adds a set of services to builder's ServiceCollection.  These define the services that can be used by the <code>WebApplication</code> instance's Dependency Injection container.</li>
<li>Builds the <code>WebApplication</code> instance.</li>
<li>Adds a set of Middleware to handle the web request pipeline serviced by the <code>WebApplication</code> instance.</li>
<li>Runs the configured <code>WebApplication</code> instance.</li>
</ol>
<h2 id="adding-a-blazor-component-to-a-razor-page">Adding a Blazor Component to a Razor Page</h2>
<p>Add a <em>Components</em> folder and a <em>/Component/HelloBlazor.razor</em> component file.</p>
<p>It just displays a message and the time.  We use the time so we can easily see if updates happen and when render events occur.</p>
<pre><code class="language-csharp"><div>@inherits ComponentBase
@namespace Blazr

&lt;div&gt;
    &lt;h1&gt;Hello Blazor at @(time.ToLongTimeString())&lt;/h1&gt;
    &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;m-3&quot;</span>&gt;
        Todays Message <span class="hljs-keyword">is</span> : @Message
    &lt;/div&gt;
    &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;m-3&quot;</span>&gt;
        &lt;button <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span> @onclick=<span class="hljs-string">&quot;GetTime&quot;</span>&gt;Set Time&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;

@code {
    [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Message {<span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>;} = <span class="hljs-keyword">string</span>.Empty;

    <span class="hljs-keyword">private</span> DateTime time = DateTime.Now;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnInitialized</span>(<span class="hljs-params"></span>)</span> 
        =&gt;  time = DateTime.Now;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetTime</span>(<span class="hljs-params"></span>)</span> 
        =&gt; time = DateTime.Now;
}
</div></code></pre>
<p>Add a <em>Component.cshtml</em> to <em>Pages</em>.</p>
<pre><code><code><div>@page
@{
    ViewData[&quot;Title&quot;] = &quot;Component page&quot;;
}

&lt;div class=&quot;text-center&quot;&gt;
    &lt;h1 class=&quot;display-4&quot;&gt;Welcome To my Component Page&lt;/h1&gt;
    @(await Html.RenderComponentAsync&lt;Components.HelloBlazor&gt;(RenderMode.ServerPrerendered, new { Message = &quot;Hello there!&quot; }))

    &lt;script src=&quot;_framework/blazor.server.js&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
</div></code></code></pre>
<p>In <em>_layout.cshtml</em> add a new top menu item:</p>
<pre><code class="language-html"><div>    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-link text-dark&quot;</span> <span class="hljs-attr">asp-area</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">asp-page</span>=<span class="hljs-string">&quot;/Component&quot;</span>&gt;</span>Component<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</div></code></pre>
<p>You should now be able to navigate to <em>Component</em> and see the page render.  Click on the button and,  nothing happens.</p>
<p>We have a component that is statically rendered by the server.  However, there's no Blazor services configured.  Open Developer tools and you will see a JS error.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/blazor-server-js-error.png" alt="JS Error"></p>
<p>The Server has pre-rendered the component and then passed the generated markup to the browser.  What is failing is the Blazor Server JS code.  There's no <em>_framework/blazor.server.js</em> to download.</p>
<h2 id="configuring-the-server-to-run-the-blazor-services">Configuring the Server to run the Blazor Services</h2>
<p>First we add the Blazor server-side services.  Update <code>Program</code>:</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// Add services to the container.</span>
builder.Services.AddRazorPages();
builder.Services.AddServerSideBlazor();
</div></code></pre>
<p>Now check the browser and you will see two errors.  <em>blazor.server.js</em> is now available to download, but it can't run because there's no Blazor Hub Middleware running on the server to service the SignalR requests.</p>
<p>Now add the BlazorHub middleware to <code>Program</code>:</p>
<pre><code><code><div>app.MapRazorPages();
app.MapBlazorHub();
</div></code></code></pre>
<p>Everything now runs with no errors.  But the button click doesn't work:  the time doesn't update!</p>
<p>Go to <em>HelloBlazor.razor</em> and note that VS Code is have trouble recognising <code>@onclick</code>.  We need <em><a href="http://Microsoft.AspNetCore.Components.Web">Microsoft.AspNetCore.Components.Web</a></em> to sort that.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Component-No-Library.png" alt="onclick Error"></p>
<p>Update <em>HelloBlazor.razor</em> by adding a using to the top of the file.</p>
<pre><code class="language-csharp"><div>@inherits ComponentBase
@namespace Components
@using Microsoft.AspNetCore.Components.Web  <span class="hljs-comment">// New</span>
</div></code></pre>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Component-With-Library.png" alt="onclick Error"></p>
<p>The button now works and updates the time.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Blazor-Component.png" alt="Base Template"></p>
<p>We have a Blazor Component running our Razor Server side page.  A bit of Deja-Vu for old hands!</p>
<h2 id="building-a-blazor-spa">Building a Blazor SPA</h2>
<p>Components running in a Razor page isn't a Single Page Application.  Or is it?</p>
<p>Before we build the full version - as in the Blazor templates - we'll build a very simple SPA.</p>
<p>Add a <em>_Imports.razor</em> file to the project root and add the following code.  This sets up the global assemblies for all razor components.</p>
<pre><code class="language-csharp"><div>@using System.Net.Http
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Components.Web.Virtualization
@using Microsoft.JSInterop
</div></code></pre>
<p>Add a <em>Routes</em> folder to the project and add the following razor components:</p>
<p><em>/Routes/Index.razor</em></p>
<pre><code class="language-csharp"><div>@namespace Blazr

&lt;PageTitle&gt;Index&lt;/PageTitle&gt;

&lt;h1&gt;Hello, world!&lt;/h1&gt;

Welcome to your <span class="hljs-keyword">new</span> app.
</div></code></pre>
<p><em>/Routes/Counter.razor</em></p>
<pre><code class="language-csharp"><div>@namespace Blazr

&lt;PageTitle&gt;Counter&lt;/PageTitle&gt;

&lt;h1&gt;Counter&lt;/h1&gt;

&lt;p role=<span class="hljs-string">&quot;status&quot;</span>&gt;Current count: @currentCount&lt;/p&gt;

&lt;button <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span> @onclick=<span class="hljs-string">&quot;IncrementCount&quot;</span>&gt;Click me&lt;/button&gt;

@code {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> currentCount = <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">IncrementCount</span>(<span class="hljs-params"></span>)</span>
     =&gt;  currentCount++;
}
</div></code></pre>
<p><em>/Routes/Hello.razor</em></p>
<pre><code class="language-csharp"><div>@namespace Blazr

&lt;HelloBlazor&gt;&lt;/HelloBlazor&gt;
</div></code></pre>
<p>Add an <em>Apps</em> folder and add:</p>
<p><em>/Apps/BaseApp.razor</em></p>
<pre><code class="language-html"><div>@using Microsoft.AspNetCore.Components;
@using Microsoft.AspNetCore.Components.Rendering;
@using Microsoft.AspNetCore.Components.Web;

@namespace Blazr

<span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;navbar navbar-expand-lg navbar-light bg-light&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container-fluid&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;navbar-brand&quot;</span>&gt;</span>Blazor Simple App<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;collapse navbar-collapse&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;navbarSupportedContent&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot; btn nav-link&quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&#x27;() =&gt; this.ChangeRootComponent(&quot;Index&quot;)&#x27;</span>&gt;</span>Index<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn nav-link&quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&#x27;() =&gt; this.ChangeRootComponent(&quot;Counter&quot;)&#x27;</span>&gt;</span>Counter<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn nav-link&quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&#x27;() =&gt; this.ChangeRootComponent(&quot;Hello&quot;)&#x27;</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn nav-link &quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;this.GoServerIndex&quot;</span>&gt;</span>Server Home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ms-5&quot;</span>&gt;</span>
    @body
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-csharp"><div>@code {
    [<span class="hljs-meta">Inject</span>] <span class="hljs-keyword">private</span> NavigationManager? NavManager { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-keyword">string</span>, Type&gt; Routes =&gt; <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, Type&gt; {
        {<span class="hljs-string">&quot;Index&quot;</span>, <span class="hljs-keyword">typeof</span>(Blazr.Index)},
        {<span class="hljs-string">&quot;Counter&quot;</span>, <span class="hljs-keyword">typeof</span>(Blazr.Counter)},
        {<span class="hljs-string">&quot;Hello&quot;</span>, <span class="hljs-keyword">typeof</span>(Blazr.Hello)}
    };

    <span class="hljs-keyword">private</span> Type rootComponent = <span class="hljs-keyword">typeof</span>(Blazr.Index);

    <span class="hljs-keyword">private</span> RenderFragment body =&gt; (RenderTreeBuilder builder) =&gt;
    {
        builder.OpenComponent(<span class="hljs-number">0</span>, rootComponent);
        builder.CloseComponent();
    };

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ChangeRootComponent</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> route</span>)</span>
    {
        <span class="hljs-keyword">if</span> (Routes.ContainsKey(route))
        {
            rootComponent = Routes[route];
            StateHasChanged();
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GoServerIndex</span>(<span class="hljs-params"></span>)</span>
    =&gt; <span class="hljs-keyword">this</span>.NavManager?.NavigateTo(<span class="hljs-string">&quot;/Index&quot;</span>, <span class="hljs-literal">true</span>);
}
</div></code></pre>
<p><code>rootComponent</code> is the <code>Type</code> of component to render: the default is <code>Index.razor</code>.  The Nav bar calls <code>ChangeRootComponent</code> which changes <code>rootComponent</code> and requests a component re-render by calling <code>StateHasChanged</code>.</p>
<p><code>body</code> is a <code>RenderFragment</code> that simply adds <code>rootComponent</code> to the render tree and renders it.  In practice we would check that <code>rootComponent</code> implements <code>IComponent</code>: all components must implement <code>IComponent</code>.  I haven't implemented the code to keep things simple and easy to read.</p>
<p><code>GoHome</code> uses the <code>NavigationManager</code> to trigger a full browser reload, and thus loads the default server page.</p>
<p>Add a link to <em>_Layout.cshtml</em></p>
<pre><code class="language-html"><div>    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-link text-dark&quot;</span> <span class="hljs-attr">asp-area</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">asp-page</span>=<span class="hljs-string">&quot;/SimpleBlazor&quot;</span>&gt;</span>Blazor Simple App<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</div></code></pre>
<p>Add <em>/Pages/SimpleBlazor.cshtml</em></p>
<pre><code><code><div>@page
@{
    Layout = null;
}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;@ViewData[&quot;Title&quot;] - BlazorServer&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;~/lib/bootstrap/dist/css/bootstrap.min.css&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;~/css/site.css&quot; asp-append-version=&quot;true&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;~/BlazorServer.styles.css&quot; asp-append-version=&quot;true&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
        @(await Html.RenderComponentAsync&lt;Blazr.BaseApp&gt;(RenderMode.ServerPrerendered))

    &lt;script src=&quot;_framework/blazor.server.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</div></code></code></pre>
<p>You should now be able to navigate to the Simple App, and navigate between the top menu bar links.</p>
<p><img src="https://shauncurtis.github.io/articles/assets/Blazor-App/Simple-Blazor.png" alt="Base Template"></p>
<h3 id="section-summary">Section Summary</h3>
<p>We've created a server side razor page, loading a Blazor component as it's main content.  This component consists of a navigation bar and a sub-component.  Clicking on the links in the navigation bar just change out the sub-component.  <code>StateHasChanged</code> queues a re-render of the page on the Renderer's queue.  The Renderer runs the render (in reality a <code>RenderFragment</code> that represents the page), works out any differences between the old DOM and the new DOM, and passes those to the browser to update the browser displayed DOM.  No page navigation involved, just DOM changes.</p>
<h2 id="building-a-full-blazor-server-app">Building a Full Blazor Server App</h2>
<h3 id="adding-files-from-the-repo">Adding files from the Repo</h3>
<p>We need to add some files from the Blazor application.</p>
<p>Add a <em>/Routes/Shared</em> folder and add the following files from the Repo:</p>
<ul>
<li><em>MainLayout.razor</em></li>
<li><em>MainLayout.razor.css</em></li>
<li><em>NavMenu.razor</em></li>
<li><em>NavMenu.razor.css</em></li>
</ul>
<p>These are the standard files from the Blazor Template with the namespace set and the NavLinks tweaked.</p>
<p>Add the following file to wwwroot/css</p>
<ul>
<li>blazor-site.css</li>
</ul>
<p>This is the standard Blazor site file renamed.</p>
<h3 id="app-component">App Component</h3>
<p>Add <em>/Apps/App.razor</em> and add the out-of-the-box code.</p>
<pre><code class="language-csharp"><div>@namespace Blazr
&lt;Router AppAssembly=<span class="hljs-string">&quot;@typeof(App).Assembly&quot;</span>&gt;
    &lt;Found Context=<span class="hljs-string">&quot;routeData&quot;</span>&gt;
        &lt;RouteView RouteData=<span class="hljs-string">&quot;@routeData&quot;</span> DefaultLayout=<span class="hljs-string">&quot;@typeof(MainLayout)&quot;</span> /&gt;
        &lt;FocusOnNavigate RouteData=<span class="hljs-string">&quot;@routeData&quot;</span> Selector=<span class="hljs-string">&quot;h1&quot;</span> /&gt;
    &lt;/Found&gt;
    &lt;NotFound&gt;
        &lt;PageTitle&gt;Not found&lt;/PageTitle&gt;
        &lt;LayoutView Layout=<span class="hljs-string">&quot;@typeof(MainLayout)&quot;</span>&gt;
            &lt;p role=<span class="hljs-string">&quot;alert&quot;</span>&gt;Sorry, there<span class="hljs-string">&#x27;s nothing at this address.&lt;/p&gt;
        &lt;/LayoutView&gt;
    &lt;/NotFound&gt;
&lt;/Router&gt;
</span></div></code></pre>
<h3 id="routing">Routing</h3>
<p>For routing to work, we need to add router page attributes to components we want the Router to treat as routes.</p>
<p>Update the following components, adding a page route.  A component can have more than one route.</p>
<p><em>Routes/Index.razor</em></p>
<pre><code class="language-html"><div>@page &quot;/&quot;
@page &quot;/App&quot;
......
</div></code></pre>
<p><em>Routes/Counter.razor</em></p>
<pre><code class="language-html"><div>@page &quot;/Counter&quot;
......
</div></code></pre>
<p><em>Routes/Hello.razor</em></p>
<pre><code class="language-html"><div>@page &quot;/Hello&quot;
......
</div></code></pre>
<h3 id="razor-server-side-pages">Razor Server-Side Pages</h3>
<p>Add <em>/Pages/Shared/_AppLayout.cshtml</em>.</p>
<p>This is the Blazor Server launch page, with a tweeked stylesheet setup.</p>
<pre><code class="language-html"><div>@using Microsoft.AspNetCore.Components.Web
@namespace Layouts
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;~/&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;~/lib/bootstrap/dist/css/bootstrap.min.css&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;css/blazor-site.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;BlazorServer.styles.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;typeof(HeadOutlet)&quot;</span> <span class="hljs-attr">render-mode</span>=<span class="hljs-string">&quot;ServerPrerendered&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    @RenderBody()

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;blazor-error-ui&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">include</span>=<span class="hljs-string">&quot;Staging,Production&quot;</span>&gt;</span>
            An error has occurred. This application may no longer respond until reloaded.
        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">include</span>=<span class="hljs-string">&quot;Development&quot;</span>&gt;</span>
            An unhandled exception has occurred. See browser dev tools for details.
        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;reload&quot;</span>&gt;</span>Reload<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dismiss&quot;</span>&gt;</span>🗙<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;_framework/blazor.server.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Add <em>/Pages/App.cshtml</em>.</p>
<p>This is the Blazor App launch page.  We specify <code>Blazor.App</code> as the launch class i.e. <em>App.razor</em>.</p>
<pre><code class="language-html"><div>@page 
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = &quot;_AppLayout&quot;;
}

<span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;typeof(Blazr.App)&quot;</span> <span class="hljs-attr">render-mode</span>=<span class="hljs-string">&quot;ServerPrerendered&quot;</span> /&gt;</span>

</div></code></pre>
<h3 id="navigation-changes">Navigation Changes</h3>
<p>Update <em>/Routes/Shared/NavMenu.razor</em></p>
<p>Add a new NavLink.</p>
<pre><code class="language-html"><div>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item px-3&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">NavLink</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn nav-link&quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;GoServerIndex&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;oi oi-list-rich&quot;</span> <span class="hljs-attr">aria-hidden</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> Server Home
        <span class="hljs-tag">&lt;/<span class="hljs-name">NavLink</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<p>And add the <code>GoServerIndex</code> method to &quot;hard&quot; navigate to the server-side home page.</p>
<pre><code class="language-csharp"><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GoServerIndex</span>(<span class="hljs-params"></span>)</span>
        =&gt; <span class="hljs-keyword">this</span>.NavManager?.NavigateTo(<span class="hljs-string">&quot;/Index&quot;</span>, <span class="hljs-literal">true</span>);
</div></code></pre>
<h3 id="web-changes">Web Changes</h3>
<p>Add a new link to the main page navigation in <em>/Pages/Shared/_Layout.cshtml</em>.</p>
<pre><code class="language-html"><div>    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav-link text-dark&quot;</span> <span class="hljs-attr">asp-area</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">asp-page</span>=<span class="hljs-string">&quot;/App&quot;</span>&gt;</span>Blazor App<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</div></code></pre>
<p>Add a Fallback page endpoint to <code>Program</code>.  All fallbacks are directed to the Blazor Application.</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">//.....</span>
app.MapBlazorHub();
app.MapFallbackToPage(<span class="hljs-string">&quot;/App&quot;</span>);

app.Run();
</div></code></pre>
<p>You should now be able to navigate to the application and F5 to reload it.</p>
<h3 id="section-summary-1">Section Summary</h3>
<p>We now have a full blown Blazor Server application running with routing.  It's important to differentiate between Blazor Routing and Browser Navigation.  One way to physically detect the difference is to watch the &quot;Refresh&quot; button in the toolbar - the circle next to the forward button.  You can see it activate when you have a browser navigation event.</p>
<p>Routing occurs when you click the left Nav Menu in the Blazor application.  You may be clicking on an <code>anchor</code>, but the browser event is intercepted by the Blazor Javascript code, and received by the <code>Router</code> component.  It has a dictionary of Routes/Component - built by finding all the components with an <code>@page</code> attribute in the current assembly.  It looks up the component against the route, and loads the new component.  We created a very simple version of this in the Simple Blazor component.</p>
<h2 id="setting-the-blazor-app-as-default">Setting the Blazor App as Default</h2>
<p>The current setup has an <code>Index.cshtml</code> page with no <code>@page</code> set.  This is the default page for the site <em><a href="https://localhost">https://localhost</a>:nnnnn/</em>.</p>
<p>If there is a Blazor route component set as <code>@page &quot;/&quot;</code> why doesn't it use it?  This is where calling Blazor components with a route attribute &quot;Pages&quot; causes confusion.  Don't call them anything but a page: Routes, RouteComponents or RouteViews.  The web server knows nothing about the Blazor Routes.  The request runs through the configured middleware pipeline in Program. In our setup <code>app.MapRazorPages()</code> maps the Razor pages in <em>Pages</em> to the web route.  If it finds an index or default web file it uses it.</p>
<p>To understand what's happening look at the endpoint mapping in <code>Program</code></p>
<pre><code class="language-csharp"><div>
app.MapRazorPages();
app.MapBlazorHub();
app.MapFallbackToPage(<span class="hljs-string">&quot;/App&quot;</span>);

app.Run();
</div></code></pre>
<p>The current <code>Index.cshtml</code> is considered a default page and MapRazorPages() returns it.</p>
<p>To change our setup, set the page attribute on <em>Index.cshtml</em>.</p>
<pre><code class="language-html"><div>@page &quot;/index&quot;
@model IndexModel
</div></code></pre>
<p><code>MapRazorPages</code> now maps <code>Index.cshtml</code> to <em><a href="https://localhost">https://localhost</a>:nnnnn/Index</em> and no longer treats it as a default page.</p>
<p>The request hits <code>app.MapFallbackToPage(&quot;/App&quot;)</code> which returns <code>App.cshtml</code> our Blazor App startup page.</p>
<h3 id="navigation-within-a-blazor-app">Navigation within a Blazor App</h3>
<p>So what happens if we have a link in the Blazor App that navigates to the web server <em>Index</em>?  We can see this <code>NavMenu</code>.</p>
<p>If we were to code <code>GoServerIndex</code> like this:</p>
<pre><code class="language-csharp"><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GoServerIndex</span>(<span class="hljs-params"></span>)</span>
        =&gt; <span class="hljs-keyword">this</span>.NavManager?.NavigateTo(<span class="hljs-string">&quot;/Index&quot;</span>);
</div></code></pre>
<p>Blazor treats the request as local so routes, rather than navigates.  The router can't find a route match so displays it's &quot;Sorry, there's nothing at this address.&quot; message.</p>
<p>To &quot;hard&quot; navigate we need to do this:</p>
<pre><code class="language-csharp"><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GoServerIndex</span>(<span class="hljs-params"></span>)</span>
        =&gt; <span class="hljs-keyword">this</span>.NavManager?.NavigateTo(<span class="hljs-string">&quot;/Index&quot;</span>, <span class="hljs-literal">true</span>);
</div></code></pre>
<p>This forces the <code>NavigationManager</code> to navigate, not route.</p>
<h2 id="summary">Summary</h2>
<p>There are a few tweeks I've made that make my implementation different from the out-of-the-box template.  These are:</p>
<ol>
<li>I've removed FetchData, it just complicates things.</li>
<li>The App <code>NavMenu</code> points Index to <em>/App</em> and not <em>/</em>.</li>
<li><em>Index.razor</em> has an added <code>@page &quot;/App&quot;</code>.</li>
<li>All the Blazor <em>Pages</em> components are now in <em>Routes</em>.</li>
</ol>
<p>2 and 3 fix the &quot;default page problem&quot; i.e. the default page is the server razor file, not the Blazor Application.</p>

    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2022</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
