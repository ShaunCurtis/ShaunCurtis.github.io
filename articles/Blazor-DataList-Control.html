<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="This article describes how to build an input control based on a DataList in Blazor, and make it behave like a Select.  Along the way it looks at how `InputBase` controls are built and work." >
<meta name="author" content="Shaun Curtis" >



<title>A Blazor DataList Control</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="904d433f-b885-4ff3-a8c7-2b9ad202bd28" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="904d433f-b885-4ff3-a8c7-2b9ad202bd28" >
<a class="dropdown-item" href="/articles/A-Flexible-App.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Brick-By-Brick.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Brick By Brick
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/Building-Blazor-List-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Blazor List Components and the Notification Pattern
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/Policy-Based-Authorization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Policy Base Authorization in Blazor
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="f2963898-77dc-4295-9b17-5392e692552a" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="f2963898-77dc-4295-9b17-5392e692552a" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="52ebb0bd-8b7b-4a01-9df6-a84b2d6bdd91" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Building Blazor Applications</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="52ebb0bd-8b7b-4a01-9df6-a84b2d6bdd91" >
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-A-Blazor-AutoComplete-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Blazor Autocomplete Control
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Building-Wrapper-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Wrapper Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Leaner-Meaner-Greener-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Leaner Meaner Greener Components
</a>
<a class="dropdown-item" href="/Building-Blazor-Applications/Rebuilding-Counter.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Rebuilding Counter
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="19e50da5-1f86-4445-94a6-2d73f8af79f2" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="19e50da5-1f86-4445-94a6-2d73f8af79f2" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="101ae064-8b8c-4daf-b2dc-e0fe02afbdf9" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="101ae064-8b8c-4daf-b2dc-e0fe02afbdf9" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="ad935bde-660a-4ee8-9787-c69a223d3eac" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Posts</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="ad935bde-660a-4ee8-9787-c69a223d3eac" >
<a class="dropdown-item" href="/posts/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/posts/Blazor-Bootstrap-Toaster.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Bootstrap Toaster
</a>
<a class="dropdown-item" href="/posts/Blazor-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Services
</a>
<a class="dropdown-item" href="/posts/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/posts/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/posts/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/posts/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Notification Service Pattern
</a>
<a class="dropdown-item" href="/posts/The-Blazor-WASM-Hosted-Project.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor WASM Hosted Project
</a>
<a class="dropdown-item" href="/posts/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 22-03-2021 >
<div>Published: 22-03-2021</div>
<div>Last Updated: 26-03-2021</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#the-html-datalist">The Html DataList</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#example-site-and-code-repository">Example Site and Code Repository</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#exploring-binding-in-a-test-control">Exploring binding in a Test Control</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#inputbase">InputBase</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#building-our-datalist-control">Building our DataList Control</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#build-the-control">Build the control</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#input-search-select-control">Input Search Select Control</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#wrap-up">Wrap Up</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>A Blazor DataList Control</h1>
<div>This article describes how to build an input control based on a DataList in Blazor, and make it behave like a Select.  Along the way it looks at how `InputBase` controls are built and work.</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <p>This article describes how to build an input control based on a DataList in Blazor, and make it behave like a Select.  <em>DataList</em> apppeared in HTML5.  Some browsers, particularly Safari were slow on the uptake, so usage was a bit problematic in the early days of HTML5.  Today, all the major browsers on various platforms support it: you can see the support list <a href="https://caniuse.com/?search=datalist">here</a>.</p>
<p>We'll build two versions of the control using Blazor's <code>InputBase</code> as the base class to fit into the existing edit form framework.  Along the way we delve into the inner workings of <code>InputBase</code> and explore control binding.</p>
<h2 id="the-html-datalist">The Html DataList</h2>
<p>When <code>Input</code> is linked to a <code>datalist</code>, it makes filtered suggestions as the user types based on the <code>datalist</code>.  Out-of-the-box, the user can select a suggestion or enter any text value.  The basic markup for the control is shown below.</p>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;countrylist&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;countrylist&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Algeria&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Australia&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Austria&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">datalist</span>&gt;</span>
</div></code></pre>
<h2 id="example-site-and-code-repository">Example Site and Code Repository</h2>
<p>The code is in a my <a href="https://github.com/ShaunCurtis/Blazor.Database/">Blazor.Database</a> repository <a href="https://github.com/ShaunCurtis/Blazor.Database/tree/master/Blazor.SPA/Components/FormControls">here in Blazor.SPA/Components/FormControls</a></p>
<p>The controls can be seen in action <a href="https://cec-blazor-database.azurewebsites.net/editorcontrols">here on my Blazor.Database Demo Site</a>.</p>
<h2 id="exploring-binding-in-a-test-control">Exploring binding in a Test Control</h2>
<p>Before we build our controls, let's explore what's going on in bindings.  You can skip this section if you know your bind triumvirate.</p>
<p>Start with a standard Razor component and code behind file - <em>MyInput.razor</em> and <em>MyInput.Razor.cs</em>.</p>
<p>Add the following code to <em>MyInput.razor.cs</em>.</p>
<ol>
<li>We have what is known as the &quot;Triumverate&quot; of bind properties.
<ol>
<li><code>Value</code> is the actual value to display.</li>
<li><code>ValueChanged</code> is a Callback that gets wired up to set the value in the parent.</li>
<li><code>ValueExpression</code> is a lambda expression that points back to the source property in the parent.  It's used to generate a <code>FieldIdentifier</code> used in validation and state management to uniquely identify the field.</li>
</ol>
</li>
<li><code>CurrentValue</code> is the control internal <em>Value</em>.  It updates <code>Value</code> and invokes <code>ValueChanged</code> when changed.</li>
<li><code>AdditionalAttributes</code> is used to capture the class and other attributes added to the control.</li>
</ol>
<pre><code class="language-csharp"><div><span class="hljs-keyword">namespace</span> <span class="hljs-title">MyNameSpace.Components</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyInput</span>
    {
        [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Value { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> EventCallback&lt;<span class="hljs-keyword">string</span>&gt; ValueChanged { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> Expression&lt;Func&lt;<span class="hljs-keyword">string</span>&gt;&gt; ValueExpression { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        [<span class="hljs-meta">Parameter(CaptureUnmatchedValues = true)</span>] <span class="hljs-keyword">public</span> IReadOnlyDictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">object</span>&gt; AdditionalAttributes { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">string</span> CurrentValue
        {
            <span class="hljs-keyword">get</span> =&gt; Value;
            <span class="hljs-keyword">set</span>
            {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">value</span>.Equals(<span class="hljs-keyword">this</span>.Value))
                {
                    Value = <span class="hljs-keyword">value</span>;
                    <span class="hljs-keyword">if</span> (ValueChanged.HasDelegate)
                        _ = ValueChanged.InvokeAsync(<span class="hljs-keyword">value</span>);
                }
            }
        }
    }
}
</div></code></pre>
<p>Add a Text <code>input</code> html control to the razor file.</p>
<ol>
<li>Namespace is added so <em>Components</em> can be divided into subfolders as the number of source files grow.</li>
<li><code>@bind-value</code> points to the controls <code>CurrentValue</code> property.</li>
<li><code>@attributes</code> adds the control attributes to <code>input</code>.</li>
</ol>
<pre><code class="language-html"><div>@namespace MyNameSpace.Components

<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">bind-value</span>=<span class="hljs-string">&quot;this.CurrentValue&quot;</span> @<span class="hljs-attr">attributes</span>=<span class="hljs-string">&quot;this.AdditionalAttributes&quot;</span> /&gt;</span>
</div></code></pre>
<h4 id="test-page">Test Page</h4>
<p>Add a Test page to <em>Pages</em> - or overwrite index if you're using a test site.  We'll use this for testing all the controls.</p>
<p>This doesn't need much explanation.  Bootstrap for formatting, classic <code>EditForm</code>.  <code>CheckButton</code> gives us a easy breakpoint we can hit to check values and objects.</p>
<p>You can see our <code>MyInput</code> in the form.</p>
<pre><code class="language-html"><div>@page &quot;/&quot;

@using MyNameSpace.Components

<span class="hljs-tag">&lt;<span class="hljs-name">EditForm</span> <span class="hljs-attr">Model</span>=<span class="hljs-string">&quot;this.model&quot;</span> <span class="hljs-attr">OnValidSubmit</span>=<span class="hljs-string">&quot;this.ValidSubmit&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container m-5 p-4 border border-secondary&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-12&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Test Editor<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;txtcountry&quot;</span>&gt;</span>
                Country
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">MyInput</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txtcountry&quot;</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;model.Value&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">MyInput</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-6&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-6 text-right&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-secondary&quot;</span> @<span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;(e) =&gt; this.CheckButton()&quot;</span>&gt;</span>Check<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">EditForm</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span>&gt;</span>
            Test Value
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-control&quot;</span>&gt;</span>
            @this.model.Value
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span>&gt;</span>
            Test Index
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-control&quot;</span>&gt;</span>
            @this.model.index
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-csharp"><div>@code {

    Model model = <span class="hljs-keyword">new</span> Model() { Value = <span class="hljs-string">&quot;Australia&quot;</span>, index = <span class="hljs-number">2</span> };

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckButton</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">var</span> x = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ValidSubmit</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">var</span> x = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">class</span> <span class="hljs-title">Model</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Value { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-keyword">string</span>.Empty;
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> index { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-number">0</span>;
    }
}
</div></code></pre>
<p>Note the value display update as you change the text in <code>MyInput</code>.</p>
<p>Under the hood the Razor compiler builds the section containing <code>MyInput</code> into component code like this:</p>
<pre><code class="language-csharp"><div>__builder2.OpenComponent&lt;TestBlazorServer.Components.MyInput&gt;(<span class="hljs-number">12</span>);
__builder2.AddAttribute(<span class="hljs-number">13</span>, <span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;txtcountry&quot;</span>);
__builder2.AddAttribute(<span class="hljs-number">14</span>, <span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;form-control&quot;</span>);
__builder2.AddAttribute(<span class="hljs-number">15</span>, <span class="hljs-string">&quot;Value&quot;</span>, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck&lt;System.String&gt;(model.Value));
__builder2.AddAttribute(<span class="hljs-number">16</span>, <span class="hljs-string">&quot;ValueChanged&quot;</span>, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck&lt;Microsoft.AspNetCore.Components.EventCallback&lt;System.String&gt;&gt;(Microsoft.AspNetCore.Components.EventCallback.Factory.Create&lt;System.String&gt;(<span class="hljs-keyword">this</span>, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(<span class="hljs-keyword">this</span>, __value =&gt; model.Value = __value, model.Value))));
__builder2.AddAttribute(<span class="hljs-number">17</span>, <span class="hljs-string">&quot;ValueExpression&quot;</span>, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck&lt;System.Linq.Expressions.Expression&lt;System.Func&lt;System.String&gt;&gt;&gt;(() =&gt; model.Value));
__builder2.CloseComponent();
</div></code></pre>
<p>You can see the compiled c# file in the <em>obj</em> folder.  On my project this is <em>\obj\Debug\net5.0\RazorDeclaration\Components\FormControls</em>.</p>
<p><code>@bind-value</code> has translated into a full mapping to the <code>Value</code>, <code>ValueChanged</code> and <code>ValueExpression</code> triumvirate. The setting of <code>Value</code> and <code>ValueExpression</code> are self explanatory.  <code>ValueChanged</code> uses a code factory to generate a runtime method that maps to <code>ValueChanged</code> and sets model.Value to the value returned by <code>ValueChanged</code>.</p>
<p>This explains a common misconception - you can attach an event handler to <code>@onchange</code> like this:</p>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">bind-value</span> =<span class="hljs-string">&quot;model.Value&quot;</span> @<span class="hljs-attr">onchange</span>=<span class="hljs-string">&quot;(e) =&gt; myonchangehandler()&quot;</span>/&gt;</span>
</div></code></pre>
<p>There's no <code>@onchange</code> event on the control, and the one on the inner control is already bound so can't be bound a second time.  You get no error message, just no trigger.</p>
<h2 id="inputbase">InputBase</h2>
<p>Let's move on to <code>InputBase</code>.</p>
<p>First we'll look at <code>InputText</code> to see an implementation.</p>
<ol>
<li>The Html <em>input</em> <code>value</code> is bound to <code>CurrentValue</code> and <code>onchange</code> event to <code>CurrentValueAsString</code>.  Any change in the value calls the setter for <code>CurrentValueASsString</code>.</li>
<li><code>TryParseValueFromString</code> just passes on <code>value</code> (the entered value) as <code>result</code>.  There's no string to other type conversion to do.</li>
</ol>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InputText</span> : <span class="hljs-title">InputBase</span>&lt;<span class="hljs-title">string</span>?&gt;
{
    [<span class="hljs-meta">DisallowNull</span>] <span class="hljs-keyword">public</span> ElementReference? Element { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">protected</span> <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildRenderTree</span>(<span class="hljs-params">RenderTreeBuilder builder</span>)</span>
    {
        builder.OpenElement(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;input&quot;</span>);
        builder.AddMultipleAttributes(<span class="hljs-number">1</span>, AdditionalAttributes);
        builder.AddAttribute(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;class&quot;</span>, CssClass);
        builder.AddAttribute(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;value&quot;</span>, BindConverter.FormatValue(CurrentValue));
        builder.AddAttribute(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;onchange&quot;</span>, EventCallback.Factory.CreateBinder&lt;<span class="hljs-keyword">string</span>?&gt;(<span class="hljs-keyword">this</span>, __value =&gt; CurrentValueAsString = __value, CurrentValueAsString));
        builder.AddElementReferenceCapture(<span class="hljs-number">5</span>, __inputReference =&gt; Element = __inputReference);
        builder.CloseElement();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">TryParseValueFromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span>? result, [NotNullWhen(<span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span>? validationErrorMessage)</span>
    {
        result = <span class="hljs-keyword">value</span>;
        validationErrorMessage = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</div></code></pre>
<p>Let's delve into <code>InputBase</code>.</p>
<p>The <code>onchange</code> event sets <code>CurrentValueAsString</code>. Note it's not virtual, so can't be overidden.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span>? CurrentValueAsString
{
    <span class="hljs-keyword">get</span> =&gt; FormatValueAsString(CurrentValue);
    <span class="hljs-keyword">set</span>
    {
        <span class="hljs-comment">// clear the ValidationMessageStore</span>
        _parsingValidationMessages?.Clear();

        <span class="hljs-keyword">bool</span> parsingFailed;

        <span class="hljs-comment">// Error if can&#x27;t be null and value is null. </span>
        <span class="hljs-keyword">if</span> (_nullableUnderlyingType != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">string</span>.IsNullOrEmpty(<span class="hljs-keyword">value</span>))
        {
            parsingFailed = <span class="hljs-literal">false</span>;
            CurrentValue = <span class="hljs-keyword">default</span>!;
        }
        <span class="hljs-comment">// Call TryParseValueFromString.  </span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (TryParseValueFromString(<span class="hljs-keyword">value</span>, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> parsedValue, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> validationErrorMessage))
        {
            <span class="hljs-comment">// If we pass complete and set CurrentValue</span>
            parsingFailed = <span class="hljs-literal">false</span>;
            CurrentValue = parsedValue!;
        }
        <span class="hljs-keyword">else</span>
        {   
            <span class="hljs-comment">// We reach here if we fail parsing</span>
            <span class="hljs-comment">// set flags and make sure we have a ValidationMessageStore</span>
            parsingFailed = <span class="hljs-literal">true</span>;
            
            <span class="hljs-keyword">if</span> (_parsingValidationMessages == <span class="hljs-literal">null</span>)
            {
                _parsingValidationMessages = <span class="hljs-keyword">new</span> ValidationMessageStore(EditContext);
            }
            <span class="hljs-comment">// Add a parsing error message to the store</span>
            _parsingValidationMessages.Add(FieldIdentifier, validationErrorMessage);

            <span class="hljs-comment">// Since we&#x27;re not writing to CurrentValue, we&#x27;ll need to notify about modification from here</span>
            EditContext.NotifyFieldChanged(FieldIdentifier);
        }

        <span class="hljs-comment">// skip the validation notification if we were previously valid and still are</span>
        <span class="hljs-comment">// if we failed this time notify </span>
        <span class="hljs-comment">// if we failed last time but are ok now we need notify to get the validation controls cleared</span>
        <span class="hljs-keyword">if</span> (parsingFailed || _previousParsingAttemptFailed)
        {
            EditContext.NotifyValidationStateChanged();
            _previousParsingAttemptFailed = parsingFailed;
        }
    }
}
</div></code></pre>
<p>The input <code>value</code> binds to the <code>CurrentValue</code> getter, and <code>CurrentValueAsString</code> sets it.  Note again it's not <code>virtual</code> so no overide.</p>
<pre><code class="language-csharp"><div>    <span class="hljs-keyword">protected</span> TValue? CurrentValue
    {
        <span class="hljs-comment">// straight getter from Value</span>
        <span class="hljs-keyword">get</span> =&gt; Value;
        <span class="hljs-keyword">set</span>
        {
            <span class="hljs-comment">// Checks for equality between submitted value and class Value</span>
            <span class="hljs-keyword">var</span> hasChanged = !EqualityComparer&lt;TValue&gt;.Default.Equals(<span class="hljs-keyword">value</span>, Value);
            <span class="hljs-comment">// and if it&#x27;s changed</span>
            <span class="hljs-keyword">if</span> (hasChanged)
            {
                <span class="hljs-comment">// sets the class Value</span>
                Value = <span class="hljs-keyword">value</span>;
                <span class="hljs-comment">// calls the ValueChanged EventHandler to update the parent value</span>
                _ = ValueChanged.InvokeAsync(Value);
                <span class="hljs-comment">// Notifies the EditContext that the field has changed and passes the FieldIdentifier</span>
                EditContext.NotifyFieldChanged(FieldIdentifier);
            }
        }
    }
</div></code></pre>
<p>Finally, <code>TryParseValueFromString</code> is abstract so must be implemented in inherited classes.  It's purpose is to validate and convert the submitted string to the correct <code>TValue</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">TryParseValueFromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>, [MaybeNullWhen(<span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> TValue result, [<span class="hljs-title">NotNullWhen</span>(<span class="hljs-params"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span>? validationErrorMessage)</span>;
</div></code></pre>
<h2 id="building-our-datalist-control">Building our DataList Control</h2>
<p>First we need a helper class to get the country list.  Get the full class from the Repo.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">MyNameSpace.Data</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Countries</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;KeyValuePair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt;&gt; CountryList
        {
            <span class="hljs-keyword">get</span>
            {
                List&lt;KeyValuePair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt;&gt; list = <span class="hljs-keyword">new</span> List&lt;KeyValuePair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt;&gt;();
                <span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> v <span class="hljs-keyword">in</span> CountryArray)
                {
                    list.Add(<span class="hljs-keyword">new</span> KeyValuePair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt;(x, v));
                    x++;
                }
                <span class="hljs-keyword">return</span> list;
            }
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SortedDictionary&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt; CountryDictionary
        {
            <span class="hljs-keyword">get</span>
            {
                SortedDictionary&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt; list = <span class="hljs-keyword">new</span> SortedDictionary&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">string</span>&gt;();
                <span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> v <span class="hljs-keyword">in</span> CountryArray)
                {
                    list.Add(x, v);
                    x++;
                }
                <span class="hljs-keyword">return</span> list;
            }
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span>[] CountryArray = <span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>[]
        {
            <span class="hljs-string">&quot;Afghanistan&quot;</span>,
            <span class="hljs-string">&quot;Albania&quot;</span>,
            <span class="hljs-string">&quot;Algeria&quot;</span>,
.....
            <span class="hljs-string">&quot;Zimbabwe&quot;</span>,
        };
    }
}
</div></code></pre>
<h3 id="build-the-control">Build the control</h3>
<p>This is the partial class, setting <code>TValue</code> as a <code>string</code>.  There are inline explanation notes.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InputDataList</span> : <span class="hljs-title">InputBase</span>&lt;<span class="hljs-title">string</span>&gt;
{
    <span class="hljs-comment">// List of values for datalist</span>
    [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> IEnumerable&lt;<span class="hljs-keyword">string</span>&gt; DataList { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        
    <span class="hljs-comment">// parameter to restrict valid values to the list</span>
    [<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> RestrictToList { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-comment">// unique id for the datalist based on a guid - we may have more than one in a form</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> dataListId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = Guid.NewGuid().ToString();

    <span class="hljs-comment">// instruction to CurrentStringValue that we are in RestrictToList mode and the user has tabbed</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> _valueSetByTab = <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// current typed value in the input box - kept up to date by UpdateEnteredText</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> _typedText = <span class="hljs-keyword">string</span>.Empty;

    <span class="hljs-comment">// New method to parallel CurrentValueAsString</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> CurrentStringValue
    {
        <span class="hljs-keyword">get</span>
        {
            <span class="hljs-comment">// check if we have a match to the datalist and get the value from the list</span>
            <span class="hljs-keyword">if</span> (DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Any(item =&gt; item == <span class="hljs-keyword">this</span>.Value))
                <span class="hljs-keyword">return</span> DataList.First(item =&gt; item == <span class="hljs-keyword">this</span>.Value);
            <span class="hljs-comment">// if not return an empty string</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (RestrictToList)
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Empty;
            <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">return</span> _typedText;
        }
        <span class="hljs-keyword">set</span>
        {
            <span class="hljs-comment">// Check if we have a ValidationMessageStore</span>
            <span class="hljs-comment">// Either get one or clear the existing one</span>
            <span class="hljs-keyword">if</span> (_parsingValidationMessages == <span class="hljs-literal">null</span>)
                _parsingValidationMessages = <span class="hljs-keyword">new</span> ValidationMessageStore(EditContext);
            <span class="hljs-keyword">else</span>
                _parsingValidationMessages?.Clear(FieldIdentifier);

            <span class="hljs-comment">// Set defaults</span>
            <span class="hljs-keyword">string</span> val = <span class="hljs-keyword">string</span>.Empty;
            <span class="hljs-keyword">var</span> _havevalue = <span class="hljs-literal">false</span>;
            <span class="hljs-comment">// check if we have a previous valid value - we&#x27;ll stick with this is the current attempt to set the value is invalid</span>
            <span class="hljs-keyword">var</span> _havepreviousvalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Contains(<span class="hljs-keyword">value</span>);

            <span class="hljs-comment">// Set the value by tabbing in Strict mode.  We need to select the first entry in the DataList</span>
            <span class="hljs-keyword">if</span> (_setValueByTab)
            {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(<span class="hljs-keyword">this</span>._typedText))
                {
                    <span class="hljs-comment">// Check if we have at least one match in the filtered list</span>
                    _havevalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Any(item =&gt; item.Contains(_typedText, StringComparison.CurrentCultureIgnoreCase));
                    <span class="hljs-keyword">if</span> (_havevalue)
                    {
                        <span class="hljs-comment">// the the first value</span>
                        <span class="hljs-keyword">var</span> filteredList = DataList.Where(item =&gt; item.Contains(_typedText, StringComparison.CurrentCultureIgnoreCase)).ToList();
                        val = filteredList[<span class="hljs-number">0</span>];
                    }
                }
            }
            <span class="hljs-comment">// Normal set</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.RestrictToList)
            {
                <span class="hljs-comment">// Check if we have a match and set it if we do</span>
                _havevalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Contains(<span class="hljs-keyword">value</span>);
                <span class="hljs-keyword">if</span> (_havevalue)
                    val = DataList.First(item =&gt; item.Equals(<span class="hljs-keyword">value</span>));
            }
            <span class="hljs-keyword">else</span>
            {
                _havevalue = <span class="hljs-literal">true</span>;
                val = <span class="hljs-keyword">value</span>;
            }

            <span class="hljs-comment">// check if we have a valid value</span>
            <span class="hljs-keyword">if</span> (_havevalue)
            {
                <span class="hljs-comment">// assign it to current value - this will kick off a ValueChanged notification on the EditContext</span>
                <span class="hljs-keyword">this</span>.CurrentValue = val;
                <span class="hljs-comment">// Check if the last entry failed validation.  If so notify the EditContext that validation has changed i.e. it&#x27;s now clear</span>
                <span class="hljs-keyword">if</span> (_previousParsingAttemptFailed)
                {
                    EditContext.NotifyValidationStateChanged();
                    _previousParsingAttemptFailed = <span class="hljs-literal">false</span>;
                }
            }
            <span class="hljs-comment">// We don&#x27;t have a valid value</span>
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-comment">// check if we&#x27;re reverting to the last entry.  If we don&#x27;t have one the generate error message</span>
                <span class="hljs-keyword">if</span> (!_havepreviousvalue)
                {
                    <span class="hljs-comment">// No match so add a message to the message store</span>
                    _parsingValidationMessages?.Add(FieldIdentifier, <span class="hljs-string">&quot;You must choose a valid selection&quot;</span>);
                    <span class="hljs-comment">// keep track of validation state for the next iteration</span>
                    _previousParsingAttemptFailed = <span class="hljs-literal">true</span>;
                    <span class="hljs-comment">// notify the EditContext whick will precipitate a Validation Message general update</span>
                    EditContext.NotifyValidationStateChanged();
                }
            }
            <span class="hljs-comment">// Clear the Tab notification flag</span>
            _setValueByTab = <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-comment">// Keep _typedText up to date with typed entry</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateEnteredText</span>(<span class="hljs-params">ChangeEventArgs e</span>)</span>
        =&gt; _typedText = e.Value.ToString();

    <span class="hljs-comment">// Detector for Tabbing away from the input</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnKeyDown</span>(<span class="hljs-params">KeyboardEventArgs e</span>)</span>
    {
        <span class="hljs-comment">// Check if we have a Tab with some text already typed and are in RestrictToList Mode</span>
        _setValueByTab = RestrictToList &amp;&amp; (!<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(e.Key)) &amp;&amp; e.Key.Equals(<span class="hljs-string">&quot;Tab&quot;</span>) &amp;&amp; !<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(<span class="hljs-keyword">this</span>._typedText);
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">TryParseValueFromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span>, [MaybeNullWhen(<span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span> result, [<span class="hljs-title">NotNullWhen</span>(<span class="hljs-params"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span> validationErrorMessage)</span>
        =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotSupportedException(<span class="hljs-string">$&quot;This component does not parse string inputs. Bind to the &#x27;<span class="hljs-subst">{<span class="hljs-keyword">nameof</span>(CurrentValue)}</span>&#x27; property, not &#x27;<span class="hljs-subst">{<span class="hljs-keyword">nameof</span>(CurrentValueAsString)}</span>&#x27;.&quot;</span>);
}
</div></code></pre>
<p>And the Razor:</p>
<ol>
<li>Input uses the CSS generated by the control.</li>
<li>Binds to <code>CurrentValue</code>.</li>
<li>Adds the additional Attributes, including the <code>Aria</code> generated by the control.</li>
<li>Binds <code>list</code> to the <code>datalist</code>.</li>
<li>Hooks up event handlers to <code>oninput</code> and <code>onkeydown</code>.</li>
<li>Builds the <code>datalist</code> from the control <code>DataList</code> property.</li>
</ol>
<pre><code class="language-html"><div>@namespace MyNameSpace.Components
@inherits InputBase<span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;@CssClass&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">bind-value</span>=<span class="hljs-string">&quot;this.CurrentStringValue&quot;</span> @<span class="hljs-attr">attributes</span>=<span class="hljs-string">&quot;this.AdditionalAttributes&quot;</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;@dataListId&quot;</span> @<span class="hljs-attr">oninput</span>=<span class="hljs-string">&quot;UpdateEnteredText&quot;</span> @<span class="hljs-attr">onkeydown</span>=<span class="hljs-string">&quot;OnKeyDown&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;@dataListId&quot;</span>&gt;</span>
    @foreach (var option in this.DataList)
    {
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;@option&quot;</span> /&gt;</span>
    }
<span class="hljs-tag">&lt;/<span class="hljs-name">datalist</span>&gt;</span>
</div></code></pre>
<p>Test the control in the test page.</p>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;txtcountry&quot;</span>&gt;</span>
        Country (Any Value)
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputDataList</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;model.Value&quot;</span> <span class="hljs-attr">DataList</span>=<span class="hljs-string">&quot;Countries.CountryArray&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Select a country&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">InputDataList</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;txtcountry&quot;</span>&gt;</span>
        Country (Strict)
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputDataList</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;model.StrictValue&quot;</span> <span class="hljs-attr">DataList</span>=<span class="hljs-string">&quot;Countries.CountryArray&quot;</span> <span class="hljs-attr">RestrictToList</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Select a country&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">InputDataList</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ValidationMessage</span> <span class="hljs-attr">For</span>=<span class="hljs-string">&quot;(() =&gt; model.StrictValue)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ValidationMessage</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span>&gt;</span>
        Country Value
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-control&quot;</span>&gt;</span>
        @this.model.Value
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span>&gt;</span>
        Country Strict Value
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-control&quot;</span>&gt;</span>
        @this.model.StrictValue
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-html"><div>class Model
{
    public string Value { get; set; } = string.Empty;
    public string StrictValue { get; set; } = string.Empty;
    public int Index { get; set; } = 0;
    public int TIndex { get; set; } = 0;
    public int Opinion { get; set; } = 0;
}
</div></code></pre>
<p>The control doesn't use <code>CurrentValueAsString</code> and <code>TryParseValueFromString</code>.  Instead We build a parallel <code>CurrentStringValue</code>,containing all the logic in both <code>CurrentValueAsString</code> and <code>TryParseValueFromString</code>, and wire the html input to it.  We don't use <code>TryParseValueFromString</code>, but as it's abstract we need to implement a blind version of it.</p>
<h2 id="input-search-select-control">Input Search Select Control</h2>
<p>The Select replacement version of the control builds on <code>InputDataList</code>.  We:</p>
<ol>
<li>Convert over to a key/value pair list with a generic key.</li>
<li>Add the extra logic for convertion from TValue to string and back in the Html <em>input</em>.</li>
<li>Add the generics handling within the class.</li>
</ol>
<p>Copy <code>InputDataList</code> and rename it to <code>InputDataListSelect</code>.</p>
<p>Add the generic declaration.  The control will work with most obvious types as the Key - e.g. int, long, string.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InputDataListSelect</span>&lt;<span class="hljs-title">TValue</span>&gt; : <span class="hljs-title">InputBase</span>&lt;<span class="hljs-title">TValue</span>&gt;
</div></code></pre>
<p>Change DataList to a <code>SortedDictionary</code>.</p>
<pre><code class="language-csharp"><div>[<span class="hljs-meta">Parameter</span>] <span class="hljs-keyword">public</span> SortedDictionary&lt;TValue, <span class="hljs-keyword">string</span>&gt; DataList { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div></code></pre>
<p>The extra private properties are as follows.</p>
<pre><code class="language-csharp"><div><span class="hljs-comment">// the EditContext ValidationMessageStore</span>
<span class="hljs-keyword">private</span> ValidationMessageStore? _parsingValidationMessages;
<span class="hljs-comment">// field to manage parsing failure</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> _previousParsingAttemptFailed = <span class="hljs-literal">false</span>;

</div></code></pre>
<p><code>CurrentValue</code> has changed a little to handle K/V pairs and do K/V pair lookups.  Again the inline comments provide detail.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">protected</span> <span class="hljs-keyword">string</span> CurrentStringValue
{
    <span class="hljs-keyword">get</span>
    {
        <span class="hljs-comment">// check if we have a match to the datalist and get the value from the K/V pair</span>
        <span class="hljs-keyword">if</span> (DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Any(item =&gt; item.Key.Equals(<span class="hljs-keyword">this</span>.Value)))
            <span class="hljs-keyword">return</span> DataList.First(item =&gt; item.Key.Equals(<span class="hljs-keyword">this</span>.Value)).Value;
        <span class="hljs-comment">// if not return an empty string</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Empty;
    }
    <span class="hljs-keyword">set</span>
    {
        <span class="hljs-comment">// Check if we have a ValidationMessageStore</span>
        <span class="hljs-comment">// Either get one or clear the existing one</span>
        <span class="hljs-keyword">if</span> (_parsingValidationMessages == <span class="hljs-literal">null</span>)
            _parsingValidationMessages = <span class="hljs-keyword">new</span> ValidationMessageStore(EditContext);
        <span class="hljs-keyword">else</span>
            _parsingValidationMessages?.Clear(FieldIdentifier);

        <span class="hljs-comment">// Set defaults</span>
        TValue val = <span class="hljs-keyword">default</span>;
        <span class="hljs-keyword">var</span> _havevalue = <span class="hljs-literal">false</span>;
        <span class="hljs-comment">// check if we have a previous valid value - we&#x27;ll stick with this is the current attempt to set the value is invalid</span>
        <span class="hljs-keyword">var</span> _havepreviousvalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.ContainsKey(<span class="hljs-keyword">this</span>.Value);

        <span class="hljs-comment">// Set the value by tabbing.  We need to select the first entry in the DataList</span>
        <span class="hljs-keyword">if</span> (_setValueByTab)
        {
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(<span class="hljs-keyword">this</span>._typedText))
            {
                <span class="hljs-comment">// Check if we have at least one K/V match in the filtered list</span>
                _havevalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.Any(item =&gt; item.Value.Contains(_typedText, StringComparison.CurrentCultureIgnoreCase));
                <span class="hljs-keyword">if</span> (_havevalue)
                {
                    <span class="hljs-comment">// the the first K/V pair</span>
                    <span class="hljs-keyword">var</span> filteredList = DataList.Where(item =&gt; item.Value.Contains(_typedText, StringComparison.CurrentCultureIgnoreCase)).ToList();
                    val = filteredList[<span class="hljs-number">0</span>].Key;
                }
            }
        }
        <span class="hljs-comment">// Normal set</span>
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-comment">// Check if we have a match and set it if we do</span>
            _havevalue = DataList != <span class="hljs-literal">null</span> &amp;&amp; DataList.ContainsValue(<span class="hljs-keyword">value</span>);
            <span class="hljs-keyword">if</span> (_havevalue)
                val = DataList.First(item =&gt; item.Value.Equals(<span class="hljs-keyword">value</span>)).Key;
        }

        <span class="hljs-comment">// check if we have a valid value</span>
        <span class="hljs-keyword">if</span> (_havevalue)
        {
            <span class="hljs-comment">// assign it to current value - this will kick off a ValueChanged notification on the EditContext</span>
            <span class="hljs-keyword">this</span>.CurrentValue = val;
            <span class="hljs-comment">// Check if the last entry failed validation.  If so notify the EditContext that validation has changed i.e. it&#x27;s now clear</span>
            <span class="hljs-keyword">if</span> (_previousParsingAttemptFailed)
            {
                EditContext.NotifyValidationStateChanged();
                _previousParsingAttemptFailed = <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-comment">// We don&#x27;t have a valid value</span>
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-comment">// check if we&#x27;re reverting to the last entry.  If we don&#x27;t have one the generate error message</span>
            <span class="hljs-keyword">if</span> (!_havepreviousvalue)
            {
                <span class="hljs-comment">// No K/V match so add a message to the message store</span>
                _parsingValidationMessages?.Add(FieldIdentifier, <span class="hljs-string">&quot;You must choose a valid selection&quot;</span>);
                <span class="hljs-comment">// keep track of validation state for the next iteration</span>
                _previousParsingAttemptFailed = <span class="hljs-literal">true</span>;
                <span class="hljs-comment">// notify the EditContext whick will precipitate a Validation Message general update</span>
                EditContext.NotifyValidationStateChanged();
            }
        }
        <span class="hljs-comment">// Clear the Tab notification flag</span>
        _setValueByTab = <span class="hljs-literal">false</span>;
    }
}
</div></code></pre>
<p><code>OnKeyDown</code> sets the <code>_setValueByTab</code> flag.</p>
<pre><code class="language-csharp"><div><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateEnteredText</span>(<span class="hljs-params">ChangeEventArgs e</span>)</span>
    =&gt; _typedText = e.Value?.ToString();

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnKeyDown</span>(<span class="hljs-params">KeyboardEventArgs e</span>)</span>
{
    <span class="hljs-comment">// Check if we have a Tab with some text already typed</span>
    _setValueByTab = ((!<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(e.Key)) &amp;&amp; e.Key.Equals(<span class="hljs-string">&quot;Tab&quot;</span>) &amp;&amp; !<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(<span class="hljs-keyword">this</span>._typedText));
}

<span class="hljs-comment">// set as blind</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">TryParseValueFromString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>? <span class="hljs-keyword">value</span>, [MaybeNullWhen(<span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> TValue result, [<span class="hljs-title">NotNullWhen</span>(<span class="hljs-params"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword">out</span> <span class="hljs-keyword">string</span> validationErrorMessage)</span>
    =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NotSupportedException(<span class="hljs-string">$&quot;This component does not parse normal string inputs. Bind to the &#x27;<span class="hljs-subst">{<span class="hljs-keyword">nameof</span>(CurrentValue)}</span>&#x27; property, not &#x27;<span class="hljs-subst">{<span class="hljs-keyword">nameof</span>(CurrentValueAsString)}</span>&#x27;.&quot;</span>);
</div></code></pre>
<p>The Razor is almost the same:</p>
<ol>
<li><code>datalist</code> changes to accommodate a K/V pair list.</li>
<li>Add the <code>@typeparam</code>.</li>
</ol>
<pre><code class="language-html"><div>@namespace Blazor.Database.Components
@inherits InputBase<span class="hljs-tag">&lt;<span class="hljs-name">TValue</span>&gt;</span>
@typeparam TValue

<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;@CssClass&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">bind-value</span>=<span class="hljs-string">&quot;this.CurrentStringValue&quot;</span> @<span class="hljs-attr">attributes</span>=<span class="hljs-string">&quot;this.AdditionalAttributes&quot;</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;@dataListId&quot;</span> @<span class="hljs-attr">oninput</span>=<span class="hljs-string">&quot;UpdateEnteredText&quot;</span> @<span class="hljs-attr">onkeydown</span>=<span class="hljs-string">&quot;OnKeyDown&quot;</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;@dataListId&quot;</span>&gt;</span>
    @foreach (var kv in this.DataList)
    {
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;@kv.Value&quot;</span> /&gt;</span>
    }
<span class="hljs-tag">&lt;/<span class="hljs-name">datalist</span>&gt;</span>
</div></code></pre>
<p>Test it by adding a row to the edit table in the test page.  Try entering an invalid string - something like &quot;xxxx&quot;.</p>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;txtcountry&quot;</span>&gt;</span>
        Country T Index
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputDataListSelect</span> <span class="hljs-attr">TValue</span>=<span class="hljs-string">&quot;int&quot;</span> @<span class="hljs-attr">bind-Value</span>=<span class="hljs-string">&quot;model.TIndex&quot;</span> <span class="hljs-attr">DataList</span>=<span class="hljs-string">&quot;Countries.CountryDictionary&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Select a country&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">InputDataListSelect</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ValidationMessage</span> <span class="hljs-attr">For</span>=<span class="hljs-string">&quot;(() =&gt; model.TIndex)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ValidationMessage</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row mb-2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-label&quot;</span>&gt;</span>
        Country T Index
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-4 form-control&quot;</span>&gt;</span>
        @this.model.TIndex
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</div></code></pre>
<pre><code class="language-csharp"><div><span class="hljs-keyword">class</span> <span class="hljs-title">Model</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Value { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-keyword">string</span>.Empty;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> StrictValue { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-keyword">string</span>.Empty;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Index { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> TIndex { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Opinion { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; } = <span class="hljs-number">0</span>;
}
</div></code></pre>
<h2 id="wrap-up">Wrap Up</h2>
<p>Building edit components is not trivial, but also should not be feared.</p>
<p>The examples I've built are based on <code>InputBase</code>.  If you start building your own controls, I thoroughly recommend taking a little time and getting familiar with <code>InputBase</code> and it's siblings.  The code is <a href="https://github.com/dotnet/aspnetcore/blob/main/src/Components/Web/src/Forms/InputBase.cs">here</a>.</p>

    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2022</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
