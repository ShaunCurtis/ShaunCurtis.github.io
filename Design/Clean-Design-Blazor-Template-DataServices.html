<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- SEO Meta Tags -->
<meta name="description" content="Your description">
<meta name="author" content="Your name">

<!-- OG Meta Tags to improve the way the post looks when you share the page on Facebook, Twitter, LinkedIn -->
<meta property="og:site_name" content="" /> <!-- website name -->
<meta property="og:site" content="" /> <!-- website link -->
<meta property="og:title" content="" /> <!-- title shown in the actual shared post -->
<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
<meta name="twitter:card" content="summary_large_image"> <!-- to have large image post format in Twitter -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="description" content="Data Services in the Clean Design Blazor Template." >
<meta name="author" content="Shaun Curtis" >



<title>Data Services in the Clean Design Blazor Template</title>


<!-- Custom fonts for this template-->
<link href="/assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">

<!-- Custom styles for this template-->
<link href="/assets/css/sb-admin-2.css" rel="stylesheet" type="text/css">
<link href="/assets/css/site.css" rel="stylesheet" type="text/css">

<!-- Favicon  -->
<link rel="icon" href="/assets/images/favicon.png">


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="/assets/css/article.css" type="text/css">
</head>
<body id="page-top">
    <!--topbar-->
    <div id="topbar">
        
<!-- Topbar -->
<nav class="navbar navbar-expand navbar-light topbar mb-4 static-top">
    
<ul class="navbar-nav" >
<li class="nav-item" >
<a class="nav-link " href="/index.html" role="button"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Index</span>
</a>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="f8547669-ca67-4d4b-8a04-4a6c0a8bc32a" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Articles</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="f8547669-ca67-4d4b-8a04-4a6c0a8bc32a" >
<a class="dropdown-item" href="/articles/A-Flexible-App.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Creating a Dynamic Blazor App Component
</a>
<a class="dropdown-item" href="/articles/Async-Programming-in-DotNetCore.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Async Programming In Dotnetcore
</a>
<a class="dropdown-item" href="/articles/Blazor-AllinOne.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor All In One - Multi SPA Hosting
</a>
<a class="dropdown-item" href="/articles/Blazor-Async-Programming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async Programming
</a>
<a class="dropdown-item" href="/articles/Blazor-Components.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Components
</a>
<a class="dropdown-item" href="/articles/Blazor-CSS.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor CSS
</a>
<a class="dropdown-item" href="/articles/Blazor-DataList-Control.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Datalist Control
</a>
<a class="dropdown-item" href="/articles/Blazor-Form-Validation.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Form Validation
</a>
<a class="dropdown-item" href="/articles/BlazorAsyncProgramming.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazorasyncprogramming
</a>
<a class="dropdown-item" href="/articles/Building-Edit-Forms.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building Edit Forms
</a>
<a class="dropdown-item" href="/articles/EditFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor EditFormState Control
</a>
<a class="dropdown-item" href="/articles/Hydra.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Hydra
</a>
<a class="dropdown-item" href="/articles/Inline-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The Blazor Inline Dialog Control
</a>
<a class="dropdown-item" href="/articles/Modal-Dialog.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Modal Dialog
</a>
<a class="dropdown-item" href="/articles/ValidationFormState.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Validation Control
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="88488184-8515-4740-95c4-073ffb7ebc4b" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Blazor Database Apps</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="88488184-8515-4740-95c4-073ffb7ebc4b" >
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 1
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 2
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 3
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 4
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 5
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building A Database Application In Blazor Part 6
</a>
<a class="dropdown-item" href="/Building-a-Database-Application-in-Blazor/index.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Building a Database Application in Blazor
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="27b5dc9d-e070-4928-ac96-be45006b035d" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Design</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="27b5dc9d-e070-4928-ac96-be45006b035d" >
<a class="dropdown-item" href="/Design/Clean-Design-In-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Clean Design Principles in Blazor Applications
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
A Blazor Clean Design Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Structure.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Structure in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-DataServices.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Data Services in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-UI.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
The UI in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Solution-Setup.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Solution Setup in the Clean Design Blazor Template
</a>
<a class="dropdown-item" href="/Design/Clean-Design-Blazor-Template-Testing.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Testing in the Clean Design Blazor Template
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="ef6a1a4d-f336-45d1-9f8a-32ac2aa35184" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Modern C#</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="ef6a1a4d-f336-45d1-9f8a-32ac2aa35184" >
<a class="dropdown-item" href="/Modern-Coding-Patterns/Nullable-And-VS-2022.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Nullable And VS 2022
</a>
</div>
</li>
<li class="nav-item dropdown no-arrow mx-1" >
<a class="nav-link dropdown-toggle" href="#" id="66b9845b-e51b-4b53-bd91-3140944dd575" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"  >
<span class="mr-2 d-none d-lg-inline text-gray-100">Posts</span>
</a>
<div class=" dropdown-list dropdown-menu shadow animated--grow-in" aria-labelledby="66b9845b-e51b-4b53-bd91-3140944dd575" >
<a class="dropdown-item" href="/posts/Blazor-Async-UI-Events.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Async UI Events
</a>
<a class="dropdown-item" href="/posts/DBContexts-In-Transient-Services.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Dbcontexts In Transient Services
</a>
<a class="dropdown-item" href="/posts/DynamicCss.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Blazor Dynamic Stylesheets
</a>
<a class="dropdown-item" href="/posts/For-ForEach-in-Blazor.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
For Foreach In Blazor
</a>
<a class="dropdown-item" href="/posts/Notification-Service-Pattern.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
Notification Service Pattern
</a>
<a class="dropdown-item" href="/posts/XML-XSD-Serialization.html" >
<i class="fas fa-file-alt fa-sm fa-fw mr-2 text-gray-600"></i>
XML XSD Serialization
</a>
</div>
</li>
</ul>

    <div class="ms-5 me-5 ml-auto">
        <h1>Cold Elm Coders</h1>
    </div>
</nav>


    </div>
    <!--End topbar-->
    <!--Sidebar-->
    <div id="sidebar">
        
<div class="article-info p-2" Published: 28-11-2021 >
<div>Published: 28-11-2021</div>
<div>Last Updated: 25-11-2021</div>
<div>Author: Shaun Curtis</div>
</div>

        
<h4 class="p-2">Table of Contents</h4>
<ul class="TOC" >
<li class="TOC-item TOC-item-0" >
<a class="TOC-link" href="#">Top</a>
<ul class="TOC TOC-0" >
<li class="TOC-item TOC-item-1" >
<ul class="TOC TOC-1" >
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#data-classes">Data Classes</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#pagingdata">PagingData</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecast">WeatherForecast</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#data-services">Data Services</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastdatastore">WeatherForecastDataStore</a>
</li>
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#iweatherforecastdatabroker">IWeatherForecastDataBroker</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#api-controllers">API Controllers</a>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#view-services">View Services</a>
<ul class="TOC TOC-2" >
<li class="TOC-item TOC-item-3" >
<a class="TOC-link" href="#weatherforecastviewservice">WeatherForecastViewService</a>
</li>
</ul>
</li>
<li class="TOC-item TOC-item-2" >
<a class="TOC-link" href="#wrap-up">Wrap up</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    <!--End Sidebar-->
    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <div id="article">
                    <!-- Article -->
                    
<!-- Header -->
<header class="ex-header-article">
    <div class="container">
        <div class="row pt-3 pb-3 border-bottom">
            <div class="col">
                
<h1>Data Services in the Clean Design Blazor Template</h1>
<div>Data Services in the Clean Design Blazor Template.</div>

            </div> <!-- end of col -->
        </div> <!-- end of row -->
    </div> <!-- end of container -->
</header> <!-- end of ex-header -->
<!-- end of header -->


                    
<!-- Article Container -->
<div class="ex-basic-1 pt-4">
    <div class="container">
        <div class="row">
            <div class="col-12">
                

        <h2 id="data-classes">Data Classes</h2>
<p>The data classes are:</p>
<h3 id="pagingdata">PagingData</h3>
<p>Project: <em>Blazr.Template.Core</em>.</p>
<p>PagingData is used to:</p>
<ol>
<li>Pass paging information to the data brokers to retrieve paged data from the data source.</li>
<li>Control the UI Paging Control behaviour.</li>
</ol>
<h3 id="weatherforecast">WeatherForecast</h3>
<p>Project: <em>Blazr.Template.Core</em>.
This is the original with the following changes:</p>
<ol>
<li>Defined as a <code>record</code> with imutable properties.</li>
<li><code>Id</code> field defined as a <code>Guid</code>.</li>
</ol>
<h2 id="data-services">Data Services</h2>
<p>The data pathway consists of three services.</p>
<ol>
<li>WeatherForecastDataStore</li>
<li>IWeatherForecastDataBroker</li>
<li>WeatherForecastViewService</li>
</ol>
<p>Providing the following methods:</p>
<ol>
<li><code>GetRecordsAsync</code>  - gets the recordset.</li>
<li><code>GetRecordCountAsync</code> - gets the record count.</li>
<li><code>GetPagedRecordsAsync</code> - gets a paged recordset.</li>
</ol>
<p>All functionality is implemented using async patterns.  Some demo code may be synchronous code in a <code>Task</code> wrapper: real database/API functionality will be async.</p>
<h3 id="weatherforecastdatastore">WeatherForecastDataStore</h3>
<p>Project: <em>Blazr.Template.Data</em>.</p>
<p>The <code>WeatherForecastDataStore</code> class emulates a database.  It's a singleton service, and on initialization builds a data set thst it then copies in responsing to data requests. The three principal public methods are shown below.  Note the use of <code>ValueTask</code> instead of <code>Task</code>.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetRecordsAsync()
    =&gt; ValueTask.FromResult(GetListCopy(_records));

<span class="hljs-function"><span class="hljs-keyword">public</span> ValueTask&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetRecordCountAsync</span>(<span class="hljs-params"></span>)</span>
    =&gt; ValueTask.FromResult(_records.Count);

<span class="hljs-keyword">public</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetPagedRecordsAsync(PagingData pagingData)
{
    pagingData.SetRecordCount( _records.Count);
    <span class="hljs-keyword">var</span> list = _records.Skip(pagingData.ReadStartRecord).Take(pagingData.PageSize).ToList();
    <span class="hljs-keyword">return</span> ValueTask.FromResult(GetListCopy(list));
}
</div></code></pre>
<h3 id="iweatherforecastdatabroker">IWeatherForecastDataBroker</h3>
<p>Project: <em>Blazr.Template.Core</em>.</p>
<p><code>IWeatherForecastDataBroker</code> defines the interface for the core domain to data domain data transfer.  Using an interface in DI decouples out two domains.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetRecordsAsync();
<span class="hljs-function"><span class="hljs-keyword">public</span> ValueTask&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">GetRecordCountAsync</span>(<span class="hljs-params"></span>)</span>;
<span class="hljs-keyword">public</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetPagedRecordsAsync(<span class="hljs-keyword">int</span> page);
</div></code></pre>
<p>There are two concrete implementations:</p>
<h4 id="weatherforecastserverdatabroker">WeatherForecastServerDataBroker</h4>
<p>Project: <em>Blazr.Template.Data</em>.</p>
<p>The server version, used by Blazor Server and the API server for Blazor WASM.  It initializes with the singleton <code>WeatherForecastDataStore</code> DI instance, and accesses the <code>WeatherForecastDataStore</code> for it's data.  <code>GetPagedRecordsAsync</code> is shown below.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetPagedRecordsAsync(PagingData pagingData)
    =&gt; _dataStore.GetPagedRecordsAsync(pagingData);
</div></code></pre>
<h4 id="weatherforecastapidatabroker">WeatherForecastAPIDataBroker</h4>
<p>Project: <em>Blazr.Template.Data</em>.</p>
<p>The WASM version.  It makes API calls through an <code>HttpClient</code> instance it gets through DI.  <code>GetPagedRecordsAsync</code> is shown below.</p>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> ValueTask&lt;List&lt;WeatherForecast&gt;&gt; GetPagedRecordsAsync(PagingData pagingData)
{
    <span class="hljs-keyword">var</span> response = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.HttpClient.PostAsJsonAsync(<span class="hljs-string">$&quot;/api/weatherforecast/GetPagedRecordsAsync&quot;</span>, pagingData);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.Content.ReadFromJsonAsync&lt;List&lt;WeatherForecast&gt;&gt;();
}
</div></code></pre>
<h2 id="api-controllers">API Controllers</h2>
<p>Project: <em>Blazr.Template.APIControllers</em>.</p>
<p>The controllers are separated into the <em>Blazr.Template.Controllers</em> project.</p>
<p><code>WeatherForecastController</code> is a bulk standard controller.  <code>GetPagedRecordsAsync</code> is shown below.</p>
<pre><code class="language-csharp"><div>[<span class="hljs-meta">Route(<span class="hljs-meta-string">&quot;/api/weatherforecast/listpaged&quot;</span>)</span>]
[<span class="hljs-meta">HttpPost</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;List&lt;WeatherForecast&gt;&gt; GetPagedRecordsAsync([FromBody] PagingData pagingData) =&gt; <span class="hljs-keyword">await</span> _dataBroker.GetPagedRecordsAsync(pagingData);
</div></code></pre>
<h2 id="view-services">View Services</h2>
<p>Project: <em>Blazr.Template.Core</em>.</p>
<h3 id="weatherforecastviewservice">WeatherForecastViewService</h3>
<p><code>WeatherForecastViewService</code> provides the data and state services for WeatherForecasts to the UI.  It's <code>Scoped</code>, one instance per SPA session.</p>
<p>It provides some important functions:</p>
<ol>
<li>Maintains one version of the truth - the WeatherForecast data set.  Components that use the service reference the record list directly, they don't keep copies.</li>
<li>Provides alerts, though Events, when the recordset changes.</li>
<li>Maintains the page being displayed within the SPA instance through page changes.</li>
<li>Uses an interface to inject and interact with the data broker.</li>
</ol>
<pre><code class="language-csharp"><div><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">WeatherForecastViewService</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IWeatherForecastDataBroker _dataBroker;
    <span class="hljs-keyword">public</span> PagingData PagingData { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; } = <span class="hljs-keyword">new</span> PagingData(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">0</span>);
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> IsLoaded =&gt; Records <span class="hljs-keyword">is</span> not <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> List&lt;WeatherForecast&gt;? Records { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; } = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler? ListChanged;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WeatherForecastViewService</span>(<span class="hljs-params">IWeatherForecastDataBroker weatherForecastDataBroker</span>)</span>
    { 
        _dataBroker = weatherForecastDataBroker;
        <span class="hljs-keyword">this</span>.PagingData.PagingChanged += <span class="hljs-keyword">this</span>.OnPageChanged;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-title">GetRecordsAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">this</span>.Records = <span class="hljs-keyword">await</span> _dataBroker.GetRecordsAsync();
        <span class="hljs-keyword">this</span>.NotifyRecordChanged();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-title">GetRecordsAsync</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> page</span>)</span>
    {
        <span class="hljs-keyword">var</span> recordCount = <span class="hljs-keyword">await</span> _dataBroker.GetRecordCountAsync();
        page = page == <span class="hljs-keyword">int</span>.MinValue ? <span class="hljs-keyword">this</span>.PagingData.Page : page;
        <span class="hljs-keyword">this</span>.PagingData.Set(page, recordCount);
        <span class="hljs-keyword">this</span>.Records = <span class="hljs-keyword">await</span> _dataBroker.GetPagedRecordsAsync(<span class="hljs-keyword">this</span>.PagingData);
        <span class="hljs-keyword">this</span>.NotifyRecordChanged();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-title">GetPagedRecordsAsync</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">this</span>.Records = <span class="hljs-keyword">await</span> _dataBroker.GetPagedRecordsAsync(<span class="hljs-keyword">this</span>.PagingData);
        <span class="hljs-keyword">this</span>.PagingData.SetRecordCountSilently(<span class="hljs-keyword">await</span> _dataBroker.GetRecordCountAsync());
        <span class="hljs-keyword">this</span>.NotifyRecordChanged();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NotifyRecordChanged</span>(<span class="hljs-params"><span class="hljs-keyword">object</span>? sender = <span class="hljs-literal">null</span></span>)</span>
    {
        sender ??= <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">this</span>.ListChanged?.Invoke(sender, EventArgs.Empty);
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnPageChanged</span>(<span class="hljs-params"><span class="hljs-keyword">object</span>? sender, EventArgs e</span>)</span>
        =&gt; <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.GetPagedRecordsAsync();
}
</div></code></pre>
<h2 id="wrap-up">Wrap up</h2>
<p>The code here is not Blazor.  It's standard dotNetCore, building classes and using the dotNetCore web server DI services.</p>

    

            </div>
        </div>
    </div>
</div>
<!-- end of Article Container -->


                </div>
                <!-- End of Main Content -->
            </div>
            <!-- Footer -->
            
<!-- Copyright -->
<footer class="sticky-footer bg-white">
    <div class="container my-auto">
        <div class="copyright text-center my-auto">
            
<span>Copyright &copy; Cold Elm Coders - 2021</span>

        </div>
    </div>
</footer>
<!-- end of copyright -->


            <!-- End of Footer -->
        </div>
        <!-- End of Content Wrapper -->
        
<a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
</a>


    </div>
    <!-- End of Page Wrapper -->
    <!-- Scripts -->
    
<!-- Scripts -->
<!-- Bootstrap core JavaScript-->
<script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/assets/js/sb-admin-2.min.js"></script>


</body>
</html>
